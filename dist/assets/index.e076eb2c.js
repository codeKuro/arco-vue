var ue=Object.defineProperty,me=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable;var E=(d,o,r)=>o in d?ue(d,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[o]=r,j=(d,o)=>{for(var r in o||(o={}))pe.call(o,r)&&E(d,r,o[r]);if(z)for(var r of z(o))fe.call(o,r)&&E(d,r,o[r]);return d},q=(d,o)=>me(d,ce(o));import{_ as ge,u as ve,t as be}from"./index.66d117c3.js";/* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               */import{d as _e,e as i,r as he,aJ as y,A as ye,B as Me,aG as a,aF as n,aL as k,aM as $,u as P,bb as ke,aR as R,aS as $e,b3 as Ve,bd as we,be as Se,bf as Ce,aQ as je,bg as Re,bj as Ie,b0 as Ue,b5 as Fe,b4 as Ne,aX as Oe,bq as qe,bp as Je}from"./arco.a53b75be.js";import{u as Ae}from"./loading.c387c5f5.js";import{b as Be,q as De,e as Le,f as Te,h as ze,i as Ee}from"./authority.dfda2478.js";import"./chart.da3854a0.js";import"./vue.0de19953.js";const Pe={class:"container"},Ge={name:"AdministratorsManagement"},Ke=_e(q(j({},Ge),{setup(d){const o=()=>({id:"",username:"",nickname:"",password:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),r=()=>({id:"",roleIds:""}),J=i(""),{loading:G,setLoading:u}=Ae(!0),{t:V}=ve(),A=i([]),B=i([]),I=i(),s=i(o()),U=i(r()),F=i(!1),v=i(!1),N=i(!1),M=i([]),K=i(!1),w=i(),b=i(!1),D={page:1,size:10},O=he(j({},D)),_=async(e={page:1,size:10})=>{u(!0);try{const{data:t}=await Be(e);A.value=t.list,O.page=e.page,O.total=t.total}catch{}finally{u(!1)}};(async(e={scopes:"admin"})=>{u(!0);try{const{data:t}=await De(e);B.value=be(t.roleList)}catch{}finally{u(!1)}})();const Q=e=>{_(q(j({},D),{page:e}))};_();const X=()=>{var e;w.value="add",(e=I.value)==null||e.resetFields(),v.value=!0},H=e=>{var f;w.value="edit";const t=Object.keys(e).reduce((m,c)=>(m[c]={value:e[c]},m),{});(f=I.value)==null||f.setFields(t),v.value=!0},W=e=>{console.log(M);const t=JSON.parse(JSON.stringify(e));t.roleIds=t.roleIds.split(","),console.log(t.roleIds),M.value=t.roleIds,U.value.id=t.id,N.value=!0},Y=async({errors:e,values:t})=>{if(!e){u(!0),b.value=!0;const f=JSON.parse(JSON.stringify(s.value));if(w.value==="add")try{await Le(f),R.success(V("administratorsManagement.form.add.success")),_()}catch(m){J.value=m.message}finally{u(!1),b.value=!1,v.value=!1}else try{await Te(f),R.success(V("administratorsManagement.form.edit.success")),_()}catch(m){J.value=m.message}finally{u(!1),b.value=!1,v.value=!1}}},Z=async e=>{F.value=!0;try{const{data:t}=await ze({id:e.id});R.success(V("administratorsManagement.form.edit.success")),_()}catch{}finally{F.value=!1}},x=async()=>{u(!0),b.value=!0,U.value.roleIds=JSON.parse(JSON.stringify(M.value));const e=JSON.parse(JSON.stringify(U.value));e.roleIds=e.roleIds.toString();try{const{data:t}=await Ee(e);R.success(V("administratorsManagement.form.bind.success")),_()}catch{}finally{u(!1),b.value=!1}};return(e,t)=>{const f=y("Breadcrumb"),m=y("icon-plus"),c=$e,S=Ve,ee=we,ae=Se,g=Ce,te=y("icon-check"),ne=y("icon-close"),L=je,le=y("icon-edit"),se=y("icon-subscribe-add"),oe=Re,ie=Ie,h=Ue,p=Fe,re=Ne,T=Oe,de=qe;return ye(),Me("div",Pe,[a(f,{items:["menu.authority","menu.authority.administratorsManagement"]},null,8,["items"]),a(ie,{class:"general-card",title:e.$t("menu.authority.administratorsManagement")},{default:n(()=>[a(ae,{style:{"margin-bottom":"16px"}},{default:n(()=>[a(ee,{span:16},{default:n(()=>[a(S,null,{default:n(()=>[a(c,{type:"primary",onClick:X},{icon:n(()=>[a(m)]),default:n(()=>[k(" "+$(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(oe,{"row-key":"id",loading:P(G),pagination:P(O),data:A.value,bordered:!1,onPageChange:Q},{columns:n(()=>[a(g,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:n(({record:l})=>[a(S,null,{default:n(()=>[a(L,{modelValue:l.status,"onUpdate:modelValue":C=>l.status=C,disabled:l.isSuperRole===1,loading:F.value,"checked-value":1,"unchecked-value":0,onChange:C=>Z(l)},{"checked-icon":n(()=>[a(te)]),"unchecked-icon":n(()=>[a(ne)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:n(({record:l})=>[a(S,null,{default:n(()=>[a(c,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:C=>H(l)},{icon:n(()=>[a(le)]),default:n(()=>[k(" "+$(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),a(c,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:C=>W(l)},{icon:n(()=>[a(se)]),default:n(()=>[k(" "+$(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),a(T,{visible:v.value,"onUpdate:visible":t[8]||(t[8]=l=>v.value=l),width:"auto",title:w.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:n(()=>[a(re,{ref_key:"formRef",ref:I,model:s.value,style:{width:"600px"},onSubmit:Y},{default:n(()=>[ke(a(p,{field:"id"},{default:n(()=>[a(h,{modelValue:s.value.id,"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.id=l)},null,8,["modelValue"])]),_:1},512),[[Je,!1]]),a(p,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(h,{modelValue:s.value.username,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.username=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(h,{modelValue:s.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.nickname=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(h,{modelValue:s.value.password,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.password=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(h,{modelValue:s.value.mobile,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.mobile=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(h,{modelValue:s.value.email,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.email=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:n(()=>[a(L,{modelValue:s.value.status,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.status=l),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),a(p,null,{default:n(()=>[a(S,null,{default:n(()=>[a(c,{loading:b.value,type:"primary","html-type":"submit"},{default:n(()=>[k($(e.$t("administratorsManagement.button.submit")),1)]),_:1},8,["loading"]),a(c,{type:"outline",onClick:t[7]||(t[7]=l=>e.$refs.formRef.resetFields())},{default:n(()=>[k($(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),a(T,{visible:N.value,"onUpdate:visible":t[10]||(t[10]=l=>N.value=l),title:e.$t("administratorsManagement.form.title.bind"),onOk:x},{default:n(()=>[a(de,{"checked-keys":M.value,"onUpdate:checked-keys":t[9]||(t[9]=l=>M.value=l),checkable:!0,"check-strictly":K.value,data:B.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var pa=ge(Ke,[["__scopeId","data-v-7b7415ec"]]);export{pa as default};
