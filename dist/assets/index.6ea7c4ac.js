var me=Object.defineProperty,ce=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var z=(u,o,r)=>o in u?me(u,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[o]=r,S=(u,o)=>{for(var r in o||(o={}))fe.call(o,r)&&z(u,r,o[r]);if(P)for(var r of P(o))ge.call(o,r)&&z(u,r,o[r]);return u},N=(u,o)=>ce(u,pe(o));import{_ as ve,u as be,t as _e}from"./index.fa1f2c20.js";/* empty css               *//* empty css               */import{u as he}from"./loading.2d4e0c4e.js";/* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               */import{d as Me,e as i,r as ye,aJ as k,A as ke,B as $e,aG as a,aF as n,aL as $,aM as w,u as E,bb as we,aR as R,aS as Ve,b3 as Ce,bd as Se,be as Re,bf as je,aQ as Ie,bg as Ue,bj as qe,b0 as Fe,b5 as Ne,b6 as Oe,b4 as Je,aX as Ae,bq as Te,bp as De}from"./arco.35997891.js";import{b as Le,q as Be,e as Pe,f as ze,h as Ee,i as Ge}from"./authority.8acf6c5c.js";import"./chart.baea2ca9.js";import"./vue.f2add872.js";const Ke={class:"container"},Qe={name:"AdministratorsManagement"},Xe=Me(N(S({},Qe),{setup(u){const o=()=>({id:"",username:"",nickname:"",password:"",passwordConfirm:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),r=()=>({id:"",roleIds:""}),O=i(""),{loading:G,setLoading:m}=he(!0),{t:v}=be(),J=i([]),A=i([]),j=i(),s=i(o()),I=i(r()),U=i(!1),b=i(!1),q=i(!1),M=i([]),K=i(!1),V=i(),_=i(!1),T={page:1,size:10},F=ye(S({},T)),Q=[{required:!0,message:v("administratorsManagement.form.placeholder.input")},{validator:(e,t)=>new Promise(c=>{window.setTimeout(()=>{e!==s.value.password&&t(v("administratorsManagement.form.password.confirm.errMsg")),c()},100)})}],h=async(e={page:1,size:10})=>{m(!0);try{const{data:t}=await Le(e);J.value=t.list,F.page=e.page,F.total=t.total}catch{}finally{m(!1)}};(async(e={scopes:"admin"})=>{m(!0);try{const{data:t}=await Be(e);A.value=_e(t.roleList)}catch{}finally{m(!1)}})();const X=e=>{h(N(S({},T),{page:e}))};h();const H=()=>{var e;V.value="add",(e=j.value)==null||e.resetFields(),b.value=!0},W=e=>{var c;V.value="edit";const t=Object.keys(e).reduce((d,f)=>(d[f]={value:e[f]},d),{});(c=j.value)==null||c.setFields(t),b.value=!0},Y=e=>{console.log(M);const t=JSON.parse(JSON.stringify(e));t.roleIds=t.roleIds.split(","),console.log(t.roleIds),M.value=t.roleIds,I.value.id=t.id,q.value=!0},Z=async({errors:e,values:t})=>{if(!e){m(!0),_.value=!0;const c=JSON.parse(JSON.stringify(s.value));if(V.value==="add")try{await Pe(c),R.success(v("administratorsManagement.form.add.success")),h()}catch(d){O.value=d.message}finally{m(!1),_.value=!1,b.value=!1}else try{await ze(c),R.success(v("administratorsManagement.form.edit.success")),h()}catch(d){O.value=d.message}finally{m(!1),_.value=!1,b.value=!1}}},x=async e=>{U.value=!0;try{const{data:t}=await Ee({id:e.id});R.success(v("administratorsManagement.form.edit.success")),h()}catch{}finally{U.value=!1}},ee=async()=>{m(!0),_.value=!0,I.value.roleIds=JSON.parse(JSON.stringify(M.value));const e=JSON.parse(JSON.stringify(I.value));e.roleIds=e.roleIds.toString();try{const{data:t}=await Ge(e);R.success(v("administratorsManagement.form.bind.success")),h()}catch{}finally{m(!1),_.value=!1}};return(e,t)=>{const c=k("icon-plus"),d=Ve,f=Ce,ae=Se,te=Re,g=je,le=k("icon-check"),ne=k("icon-close"),D=Ie,se=k("icon-edit"),oe=k("icon-subscribe-add"),ie=Ue,re=qe,y=Fe,p=Ne,L=Oe,de=Je,B=Ae,ue=Te;return ke(),$e("div",Ke,[a(re,{class:"general-card",style:{"padding-top":"16px"}},{default:n(()=>[a(te,{style:{"margin-bottom":"16px"}},{default:n(()=>[a(ae,{span:16},{default:n(()=>[a(f,null,{default:n(()=>[a(d,{type:"primary",onClick:H},{icon:n(()=>[a(c)]),default:n(()=>[$(" "+w(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(ie,{"row-key":"id",loading:E(G),pagination:E(F),data:J.value,bordered:!1,onPageChange:X},{columns:n(()=>[a(g,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:n(({record:l})=>[a(f,null,{default:n(()=>[a(D,{modelValue:l.status,"onUpdate:modelValue":C=>l.status=C,disabled:l.isSuperRole===1,loading:U.value,"checked-value":1,"unchecked-value":0,onChange:C=>x(l)},{"checked-icon":n(()=>[a(le)]),"unchecked-icon":n(()=>[a(ne)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:n(({record:l})=>[a(f,null,{default:n(()=>[a(d,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:C=>W(l)},{icon:n(()=>[a(se)]),default:n(()=>[$(" "+w(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),a(d,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:C=>Y(l)},{icon:n(()=>[a(oe)]),default:n(()=>[$(" "+w(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1}),a(B,{visible:b.value,"onUpdate:visible":t[9]||(t[9]=l=>b.value=l),width:"auto",title:V.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:n(()=>[a(de,{ref_key:"formRef",ref:j,model:s.value,style:{width:"600px"},onSubmit:Z},{default:n(()=>[we(a(p,{field:"id"},{default:n(()=>[a(y,{modelValue:s.value.id,"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.id=l)},null,8,["modelValue"])]),_:1},512),[[De,!1]]),a(p,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(y,{modelValue:s.value.username,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.username=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(y,{modelValue:s.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.nickname=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(L,{modelValue:s.value.password,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.password=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"passwordConfirm",label:e.$t("administratorsManagement.form.password.confirm"),rules:Q},{default:n(()=>[a(L,{modelValue:s.value.passwordConfirm,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.passwordConfirm=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(p,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(y,{modelValue:s.value.mobile,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.mobile=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(y,{modelValue:s.value.email,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.email=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:n(()=>[a(D,{modelValue:s.value.status,"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.status=l),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),a(p,null,{default:n(()=>[a(f,null,{default:n(()=>[a(d,{loading:_.value,type:"primary","html-type":"submit"},{default:n(()=>[$(w(e.$t("administratorsManagement.button.submit")),1)]),_:1},8,["loading"]),a(d,{type:"outline",onClick:t[8]||(t[8]=l=>e.$refs.formRef.resetFields())},{default:n(()=>[$(w(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),a(B,{visible:q.value,"onUpdate:visible":t[11]||(t[11]=l=>q.value=l),title:e.$t("administratorsManagement.form.title.bind"),onOk:ee},{default:n(()=>[a(ue,{"checked-keys":M.value,"onUpdate:checked-keys":t[10]||(t[10]=l=>M.value=l),checkable:!0,"check-strictly":K.value,data:A.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var ua=ve(Xe,[["__scopeId","data-v-7fa5d18b"]]);export{ua as default};
