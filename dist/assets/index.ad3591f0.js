var de=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var z=(d,o,i)=>o in d?de(d,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[o]=i,C=(d,o)=>{for(var i in o||(o={}))ce.call(o,i)&&z(d,i,o[i]);if(T)for(var i of T(o))pe.call(o,i)&&z(d,i,o[i]);return d},O=(d,o)=>ue(d,me(o));import{_ as fe,u as ge,t as ve}from"./index.c67f8be3.js";/* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css              *//* empty css                *//* empty css               */import{d as be,e as r,r as _e,aJ as h,A as he,B as ye,aG as a,aF as n,aL as M,aM as k,u as E,bb as Me,aR as j,aS as ke,b3 as $e,bd as Ve,be as we,bf as Se,aQ as Ce,bg as je,bj as Re,b0 as Ie,b5 as Ue,b4 as Fe,aX as Ne,bq as Oe,bp as qe}from"./arco.a53b75be.js";import{u as Je}from"./loading.c387c5f5.js";import{b as Ae,q as Be,e as De,f as Le,h as Te,i as ze}from"./authority.39e53377.js";import"./chart.da3854a0.js";import"./vue.0de19953.js";const Ee={class:"container"},Pe={name:"AdministratorsManagement"},Ge=be(O(C({},Pe),{setup(d){const o=()=>({id:"",username:"",nickname:"",password:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),i=()=>({id:"",roleIds:""}),q=r(""),{loading:P,setLoading:u}=Je(!0),{t:$}=ge(),J=r([]),A=r([]),R=r(),s=r(o()),I=r(i()),U=r(!1),v=r(!1),F=r(!1),y=r([]),G=r(!1),V=r(),B={page:1,size:10},N=_e(C({},B)),b=async(e={page:1,size:10})=>{u(!0);try{const{data:t}=await Ae(e);J.value=t.list,N.page=e.page,N.total=t.total}catch{}finally{u(!1)}};(async(e={scopes:"admin"})=>{u(!0);try{const{data:t}=await Be(e);A.value=ve(t.roleList)}catch{}finally{u(!1)}})();const K=e=>{b(O(C({},B),{page:e}))};b();const Q=()=>{var e;V.value="add",(e=R.value)==null||e.resetFields(),v.value=!0},X=e=>{var f;V.value="edit";const t=Object.keys(e).reduce((m,c)=>(m[c]={value:e[c]},m),{});(f=R.value)==null||f.setFields(t),v.value=!0},H=e=>{console.log(y);const t=JSON.parse(JSON.stringify(e));t.roleIds=t.roleIds.split(","),console.log(t.roleIds),y.value=t.roleIds,I.value.id=t.id,F.value=!0},W=async({errors:e,values:t})=>{if(!e){u(!0);const f=JSON.parse(JSON.stringify(s.value));if(V.value==="add")try{await De(f),j.success($("administratorsManagement.form.add.success")),b()}catch(m){q.value=m.message}finally{u(!1),v.value=!1}else try{await Le(f),j.success($("administratorsManagement.form.edit.success")),b()}catch(m){q.value=m.message}finally{u(!1),v.value=!1}}},Y=async e=>{U.value=!0;try{const{data:t}=await Te({id:e.id});j.success($("administratorsManagement.form.edit.success")),b()}catch{}finally{U.value=!1}},Z=async()=>{u(!0),I.value.roleIds=JSON.parse(JSON.stringify(y.value));const e=JSON.parse(JSON.stringify(I.value));e.roleIds=e.roleIds.toString(),console.log(e);try{const{data:t}=await ze(e);j.success($("administratorsManagement.form.bind.success")),b()}catch{}finally{u(!1)}};return(e,t)=>{const f=h("Breadcrumb"),m=h("icon-plus"),c=ke,w=$e,x=Ve,ee=we,g=Se,ae=h("icon-check"),te=h("icon-close"),D=Ce,ne=h("icon-edit"),le=h("icon-subscribe-add"),se=je,oe=Re,_=Ie,p=Ue,ie=Fe,L=Ne,re=Oe;return he(),ye("div",Ee,[a(f,{items:["menu.authority","menu.authority.administratorsManagement"]},null,8,["items"]),a(oe,{class:"general-card",title:e.$t("menu.authority.administratorsManagement")},{default:n(()=>[a(ee,{style:{"margin-bottom":"16px"}},{default:n(()=>[a(x,{span:16},{default:n(()=>[a(w,null,{default:n(()=>[a(c,{type:"primary",onClick:Q},{icon:n(()=>[a(m)]),default:n(()=>[M(" "+k(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(se,{"row-key":"id",loading:E(P),pagination:E(N),data:J.value,bordered:!1,onPageChange:K},{columns:n(()=>[a(g,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:n(({record:l})=>[a(w,null,{default:n(()=>[a(D,{modelValue:l.status,"onUpdate:modelValue":S=>l.status=S,disabled:l.isSuperRole===1,loading:U.value,"checked-value":1,"unchecked-value":0,onChange:S=>Y(l)},{"checked-icon":n(()=>[a(ae)]),"unchecked-icon":n(()=>[a(te)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:n(({record:l})=>[a(w,null,{default:n(()=>[a(c,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:S=>X(l)},{icon:n(()=>[a(ne)]),default:n(()=>[M(" "+k(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),a(c,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:S=>H(l)},{icon:n(()=>[a(le)]),default:n(()=>[M(" "+k(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),a(L,{visible:v.value,"onUpdate:visible":t[8]||(t[8]=l=>v.value=l),width:"auto",title:V.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:n(()=>[a(ie,{ref_key:"formRef",ref:R,model:s.value,style:{width:"600px"},onSubmit:W},{default:n(()=>[Me(a(p,{field:"id"},{default:n(()=>[a(_,{modelValue:s.value.id,"onUpdate:modelValue":t[0]||(t[0]=l=>s.value.id=l)},null,8,["modelValue"])]),_:1},512),[[qe,!1]]),a(p,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(_,{modelValue:s.value.username,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.username=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(_,{modelValue:s.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.nickname=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(_,{modelValue:s.value.password,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.password=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(_,{modelValue:s.value.mobile,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.mobile=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:n(()=>[a(_,{modelValue:s.value.email,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.email=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(p,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:n(()=>[a(D,{modelValue:s.value.status,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.status=l),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),a(p,null,{default:n(()=>[a(w,null,{default:n(()=>[a(c,{type:"primary","html-type":"submit"},{default:n(()=>[M(k(e.$t("administratorsManagement.button.submit")),1)]),_:1}),a(c,{type:"outline",onClick:t[7]||(t[7]=l=>e.$refs.formRef.resetFields())},{default:n(()=>[M(k(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),a(L,{visible:F.value,"onUpdate:visible":t[10]||(t[10]=l=>F.value=l),title:e.$t("administratorsManagement.form.title.bind"),onOk:Z},{default:n(()=>[a(re,{"checked-keys":y.value,"onUpdate:checked-keys":t[9]||(t[9]=l=>y.value=l),checkable:!0,"check-strictly":G.value,data:A.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var ca=fe(Ge,[["__scopeId","data-v-351198c6"]]);export{ca as default};
