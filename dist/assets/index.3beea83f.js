var de=Object.defineProperty,ue=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var T=(u,i,r)=>i in u?de(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,C=(u,i)=>{for(var r in i||(i={}))ce.call(i,r)&&T(u,r,i[r]);if(z)for(var r of z(i))pe.call(i,r)&&T(u,r,i[r]);return u},J=(u,i)=>ue(u,me(i));import{d as fe,r as d,O as ge,$ as ve,e as s,o as be,g as _e,f as a,w as l,i as M,t as k,u as E,a2 as he,R,a3 as ye}from"./vendor.e6e9099f.js";import{u as Me}from"./loading.3e447ed2.js";import{b as ke,q as $e,e as Ve,f as we,h as Se,i as Ce}from"./authority.927ca471.js";import{_ as Re,t as Ue}from"./index.525cc014.js";const Ie={class:"container"},Oe={name:"AdministratorsManagement"},Ne=fe(J(C({},Oe),{setup(u){const i=()=>({id:"",username:"",nickname:"",password:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),r=()=>({id:"",roleIds:""}),A=d(""),{loading:P,setLoading:m}=Me(!0),{t:$}=ge(),D=d([]),F=d([]),U=d(),o=d(i()),I=d(r()),O=d(!1),b=d(!1),N=d(!1),y=d([]),K=d(!1),V=d(),B={page:1,size:10},q=ve(C({},B)),_=async(e={page:1,size:10})=>{m(!0);try{const{data:t}=await ke(e);D.value=t.list,q.page=e.page,q.total=t.total}catch{}finally{m(!1)}};(async(e={scopes:"admin"})=>{m(!0);try{const{data:t}=await $e(e);F.value=Ue(t.roleList)}catch{}finally{m(!1)}})();const G=e=>{_(J(C({},B),{page:e}))};_();const H=()=>{var e;V.value="add",(e=U.value)==null||e.resetFields(),b.value=!0},Q=e=>{var g;V.value="edit";const t=Object.keys(e).reduce((c,p)=>(c[p]={value:e[p]},c),{});(g=U.value)==null||g.setFields(t),b.value=!0},W=e=>{console.log(y);const t=JSON.parse(JSON.stringify(e));t.roleIds=t.roleIds.split(","),console.log(t.roleIds),y.value=t.roleIds,I.value.id=t.id,N.value=!0},X=async({errors:e,values:t})=>{if(!e){m(!0);const g=JSON.parse(JSON.stringify(o.value));if(V.value==="add")try{await Ve(g),R.success($("administratorsManagement.form.add.success")),_()}catch(c){A.value=c.message}finally{m(!1),b.value=!1}else try{await we(g),R.success($("administratorsManagement.form.edit.success")),_()}catch(c){A.value=c.message}finally{m(!1),b.value=!1}}},Y=async e=>{O.value=!0;try{const{data:t}=await Se({id:e.id});R.success($("administratorsManagement.form.edit.success")),_()}catch{}finally{O.value=!1}},Z=async()=>{m(!0),I.value.roleIds=JSON.parse(JSON.stringify(y.value));const e=JSON.parse(JSON.stringify(I.value));e.roleIds=e.roleIds.toString(),console.log(e);try{const{data:t}=await Ce(e);R.success($("administratorsManagement.form.bind.success")),_()}catch{}finally{m(!1)}};return(e,t)=>{const g=s("Breadcrumb"),c=s("icon-plus"),p=s("a-button"),w=s("a-space"),x=s("a-col"),ee=s("a-row"),v=s("a-table-column"),ae=s("icon-check"),te=s("icon-close"),L=s("a-switch"),le=s("icon-edit"),ne=s("icon-subscribe-add"),se=s("a-table"),oe=s("a-card"),h=s("a-input"),f=s("a-form-item"),ie=s("a-form"),j=s("a-modal"),re=s("a-tree");return be(),_e("div",Ie,[a(g,{items:["menu.authority","menu.authority.administratorsManagement"]},null,8,["items"]),a(oe,{class:"general-card",title:e.$t("menu.authority.administratorsManagement")},{default:l(()=>[a(ee,{style:{"margin-bottom":"16px"}},{default:l(()=>[a(x,{span:16},{default:l(()=>[a(w,null,{default:l(()=>[a(p,{type:"primary",onClick:H},{icon:l(()=>[a(c)]),default:l(()=>[M(" "+k(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(se,{"row-key":"id",loading:E(P),pagination:E(q),data:D.value,bordered:!1,onPageChange:G},{columns:l(()=>[a(v,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:l(({record:n})=>[a(w,null,{default:l(()=>[a(L,{modelValue:n.status,"onUpdate:modelValue":S=>n.status=S,disabled:n.isSuperRole===1,loading:O.value,"checked-value":1,"unchecked-value":0,onChange:S=>Y(n)},{"checked-icon":l(()=>[a(ae)]),"unchecked-icon":l(()=>[a(te)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),a(v,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:l(({record:n})=>[a(w,null,{default:l(()=>[a(p,{disabled:n.isSuperRole===1,status:"success",size:"small",onClick:S=>Q(n)},{icon:l(()=>[a(le)]),default:l(()=>[M(" "+k(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),a(p,{disabled:n.isSuperRole===1,status:"success",size:"small",onClick:S=>W(n)},{icon:l(()=>[a(ne)]),default:l(()=>[M(" "+k(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),a(j,{visible:b.value,"onUpdate:visible":t[8]||(t[8]=n=>b.value=n),width:"auto",title:V.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:l(()=>[a(ie,{ref_key:"formRef",ref:U,model:o.value,style:{width:"600px"},onSubmit:X},{default:l(()=>[he(a(f,{field:"id"},{default:l(()=>[a(h,{modelValue:o.value.id,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.id=n)},null,8,["modelValue"])]),_:1},512),[[ye,!1]]),a(f,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(h,{modelValue:o.value.username,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value.username=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(f,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(h,{modelValue:o.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=n=>o.value.nickname=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(f,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(h,{modelValue:o.value.password,"onUpdate:modelValue":t[3]||(t[3]=n=>o.value.password=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(f,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(h,{modelValue:o.value.mobile,"onUpdate:modelValue":t[4]||(t[4]=n=>o.value.mobile=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(f,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(h,{modelValue:o.value.email,"onUpdate:modelValue":t[5]||(t[5]=n=>o.value.email=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(f,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:l(()=>[a(L,{modelValue:o.value.status,"onUpdate:modelValue":t[6]||(t[6]=n=>o.value.status=n),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),a(f,null,{default:l(()=>[a(w,null,{default:l(()=>[a(p,{type:"primary","html-type":"submit"},{default:l(()=>[M(k(e.$t("administratorsManagement.button.submit")),1)]),_:1}),a(p,{type:"outline",onClick:t[7]||(t[7]=n=>e.$refs.formRef.resetFields())},{default:l(()=>[M(k(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),a(j,{visible:N.value,"onUpdate:visible":t[10]||(t[10]=n=>N.value=n),title:e.$t("administratorsManagement.form.title.bind"),onOk:Z},{default:l(()=>[a(re,{"checked-keys":y.value,"onUpdate:checked-keys":t[9]||(t[9]=n=>y.value=n),checkable:!0,"check-strictly":K.value,data:F.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var Le=Re(Ne,[["__scopeId","data-v-db027092"]]);export{Le as default};
