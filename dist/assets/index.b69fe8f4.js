var ke=Object.defineProperty,Ve=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var ne=(p,s,d)=>s in p?ke(p,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):p[s]=d,se=(p,s)=>{for(var d in s||(s={}))we.call(s,d)&&ne(p,d,s[d]);if(oe)for(var d of oe(s))Re.call(s,d)&&ne(p,d,s[d]);return p},de=(p,s)=>Ve(p,Ce(s));import{_ as je,u as Se,t as Ue}from"./index.fd658db6.js";import{u as Ie}from"./index.5cdba46d.js";/* empty css              */import{q as Ne}from"./serve.6c9c9fdf.js";/* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{d as Te,e as i,r as Ae,c as qe,aJ as C,A as j,B as Fe,aG as e,aF as l,aC as A,aL as g,aM as v,aD as q,u as S,bb as ue,aR as F,aS as Ke,bc as Be,b3 as De,bd as Le,be as Oe,bf as ze,aQ as Je,bg as Pe,bh as Ee,bi as Ge,bj as He,bk as Qe,b5 as Xe,b0 as We,bl as Ye,bm as Ze,bn as xe,aP as ea,bo as aa,b4 as la,aX as ta,bp as re}from"./arco.cef754ac.js";import{q as oa,d as na,g as sa,c as da,u as ua,a as ra}from"./authority.5c53f965.js";import"./chart.ed6b2947.js";import"./vue.ba7251dd.js";const ia={class:"container"},ma={name:"RoleManagement"},ca=Te(de(se({},ma),{setup(p){const s=()=>({id:"",type:1,appName:"",name:"",identify:"",remark:"",status:0,sort:0,scopes:"admin",createdAt:"",isSupperRole:0,nodeIds:""}),d=i(""),{loading:L,setLoading:b}=Ie(!0),{t:h}=Se(),y=i("1"),K=i([]),B=i(),n=i(s()),U=i(!1),$=i(!1),w=i(!1),I=i(),_=i([]),O=Ae({type:"checkbox",showCheckedAll:!0,checkStrictly:!0}),z=i([]),N=i(!1),ie=qe(()=>[{label:h("roleManagement.form.type.1"),value:1},{label:h("roleManagement.form.type.2"),value:2}]),k=async(a=y.value==="1"?{scopes:"member"}:{scopes:"admin"})=>{b(!0);try{const{data:o}=await oa(a),u=await Ne(a);K.value=o.roleList,z.value=Ue(u.data.nodeTree)}catch{}finally{b(!1)}};k();const me=a=>{y.value=a,k()},J=()=>{var a;I.value="add",(a=B.value)==null||a.resetFields(),y.value==="1"?n.value.scopes="member":n.value.scopes="admin",$.value=!0},P=()=>{console.log(_),_.value.length?w.value=!0:F.error(h("roleManagement.button.confirmation.deleteAll"))},E=async(a={ids:_.value})=>{b(!0);try{await na(a),k()}catch(o){d.value=o.message}finally{b(!1),w.value=!1}},G=()=>{w.value=!1},H=async a=>{var o;b(!0),I.value="edit";try{const{data:u}=await sa({id:a.id}),f=Object.keys(u).reduce((m,R)=>(m[R]={value:u[R]},m),{});f.nodeIds.value=f.nodeIds.value.split(","),(o=B.value)==null||o.setFields(f),$.value=!0}catch{}finally{b(!1)}},ce=async({errors:a,values:o})=>{if(!a){b(!0),N.value=!0;const u=JSON.parse(JSON.stringify(n.value));if(console.log(n.value),u.nodeIds=u.nodeIds.toString(),I.value==="add")try{await da(u),F.success(h("roleManagement.form.add.success")),N.value=!1,k()}catch(f){d.value=f.message}finally{b(!1),$.value=!1}else try{await ua(u),F.success(h("roleManagement.form.edit.success")),N.value=!1,k()}catch(f){d.value=f.message}finally{b(!1),$.value=!1}}},Q=async a=>{U.value=!0;try{const{data:o}=await ra({id:a.id});F.success(h("roleManagement.form.edit.success")),k()}catch{}finally{U.value=!1}};function pe(){console.log(n)}return(a,o)=>{const u=C("Breadcrumb"),f=C("icon-plus"),m=Ke,R=C("icon-delete"),X=Be,V=De,W=Le,Y=Oe,r=ze,Z=C("icon-check"),x=C("icon-close"),D=Je,ee=C("icon-edit"),ae=Pe,le=Ee,fe=Ge,ge=He,ve=Qe,c=Xe,T=We,be=Ye,te=Ze,ye=xe,_e=ea,Me=aa,he=la,$e=ta;return j(),Fe("div",ia,[e(u,{items:["menu.authority","menu.authority.roleManagement"]},null,8,["items"]),e(ge,{class:"general-card",title:a.$t("menu.authority.roleManagement")},{default:l(()=>[e(fe,{modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=t=>y.value=t),"default-active-key":"1",onChange:me},{default:l(()=>[e(le,{key:"1",title:a.$t("menu.card.tabOne")},{default:l(()=>[y.value==1?(j(),A(Y,{key:0,style:{"margin-bottom":"16px"}},{default:l(()=>[e(W,{span:16},{default:l(()=>[e(V,null,{default:l(()=>[e(m,{type:"primary",onClick:J},{icon:l(()=>[e(f)]),default:l(()=>[g(" "+v(a.$t("roleManagement.operation.create")),1)]),_:1}),e(X,{"popup-visible":w.value,content:a.$t("roleManagement.button.confirmation.delete"),onOk:E,onCancel:G},{default:l(()=>[e(m,{type:"primary",onClick:P},{icon:l(()=>[e(R)]),default:l(()=>[g(" "+v(a.$t("roleManagement.operation.delete")),1)]),_:1})]),_:1},8,["popup-visible","content"])]),_:1})]),_:1})]),_:1})):q("",!0),y.value==1?(j(),A(ae,{key:1,selectedKeys:_.value,"onUpdate:selectedKeys":o[0]||(o[0]=t=>_.value=t),"row-key":"id",loading:S(L),data:K.value,bordered:!1,"row-selection":S(O),pagination:!1},{columns:l(()=>[e(r,{title:a.$t("roleManagement.columns.id"),"data-index":"id"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.name"),"data-index":"name"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.identify"),"data-index":"identify"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.createdAt"),"data-index":"createdAt"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.status"),"data-index":"status"},{cell:l(({record:t})=>[e(V,null,{default:l(()=>[e(D,{modelValue:t.status,"onUpdate:modelValue":M=>t.status=M,disabled:t.id==="1",loading:U.value,"checked-value":1,"unchecked-value":0,onChange:M=>Q(t)},{"checked-icon":l(()=>[e(Z)]),"unchecked-icon":l(()=>[e(x)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.operations"),"data-index":"operations"},{cell:l(({record:t})=>[e(m,{disabled:t.identify==="super_admin",status:"success",size:"small",onClick:M=>H(t)},{icon:l(()=>[e(ee)]),default:l(()=>[g(" "+v(a.$t("roleManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["selectedKeys","loading","data","row-selection"])):q("",!0)]),_:1},8,["title"]),e(le,{key:"2",title:a.$t("menu.card.tabTwo")},{default:l(()=>[y.value==2?(j(),A(Y,{key:0,style:{"margin-bottom":"16px"}},{default:l(()=>[e(W,{span:16},{default:l(()=>[e(V,null,{default:l(()=>[e(m,{type:"primary",onClick:J},{icon:l(()=>[e(f)]),default:l(()=>[g(" "+v(a.$t("roleManagement.operation.create")),1)]),_:1}),e(X,{"popup-visible":w.value,content:a.$t("roleManagement.button.confirmation.delete"),onOk:E,onCancel:G},{default:l(()=>[e(m,{type:"primary",onClick:P},{icon:l(()=>[e(R)]),default:l(()=>[g(" "+v(a.$t("roleManagement.operation.delete")),1)]),_:1})]),_:1},8,["popup-visible","content"])]),_:1})]),_:1})]),_:1})):q("",!0),y.value==2?(j(),A(ae,{key:1,selectedKeys:_.value,"onUpdate:selectedKeys":o[1]||(o[1]=t=>_.value=t),"row-key":"id",loading:S(L),data:K.value,bordered:!1,"row-selection":S(O),pagination:!1},{columns:l(()=>[e(r,{title:a.$t("roleManagement.columns.id"),"data-index":"id"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.name"),"data-index":"name"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.identify"),"data-index":"identify"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.createdAt"),"data-index":"createdAt"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.status"),"data-index":"status"},{cell:l(({record:t})=>[e(V,null,{default:l(()=>[e(D,{modelValue:t.status,"onUpdate:modelValue":M=>t.status=M,disabled:t.identify==="super_admin",loading:U.value,"checked-value":1,"unchecked-value":0,onChange:M=>Q(t)},{"checked-icon":l(()=>[e(Z)]),"unchecked-icon":l(()=>[e(x)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.operations"),"data-index":"operations"},{cell:l(({record:t})=>[e(m,{disabled:t.identify==="super_admin",status:"success",size:"small",onClick:M=>H(t)},{icon:l(()=>[e(ee)]),default:l(()=>[g(" "+v(a.$t("roleManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["selectedKeys","loading","data","row-selection"])):q("",!0)]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["title"]),e($e,{visible:$.value,"onUpdate:visible":o[14]||(o[14]=t=>$.value=t),width:"auto",title:I.value==="add"?a.$t("roleManagement.form.title.add"):a.$t("roleManagement.form.title.edit"),footer:!1},{default:l(()=>[e(he,{ref_key:"formRef",ref:B,model:n.value,style:{width:"600px"},onSubmit:ce},{default:l(()=>[ue(e(c,{field:"type",label:a.$t("roleManagement.form.type"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.select")}]},{default:l(()=>[e(ve,{modelValue:n.value.type,"onUpdate:modelValue":o[3]||(o[3]=t=>n.value.type=t),options:S(ie),placeholder:a.$t("roleManagement.form.placeholder.select")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label","rules"]),[[re,!1]]),ue(e(c,{field:"id"},{default:l(()=>[e(T,{modelValue:n.value.id,"onUpdate:modelValue":o[4]||(o[4]=t=>n.value.id=t)},null,8,["modelValue"])]),_:1},512),[[re,!1]]),e(c,{field:"name",label:a.$t("roleManagement.form.name"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.name,"onUpdate:modelValue":o[5]||(o[5]=t=>n.value.name=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(c,{field:"appName",label:a.$t("roleManagement.form.appName"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.appName,"onUpdate:modelValue":o[6]||(o[6]=t=>n.value.appName=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(c,{field:"nodeIds",label:a.$t("roleManagement.form.nodeIds"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.select")}]},{default:l(()=>[e(be,{modelValue:n.value.nodeIds,"onUpdate:modelValue":o[7]||(o[7]=t=>n.value.nodeIds=t),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,"tree-check-strictly":!0,"max-tag-count":4,data:z.value,placeholder:a.$t("roleManagement.form.placeholder.select"),"dropdown-style":{minHeight:"300px",overflow:"auto"},onChange:pe},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),e(c,{field:"identify",label:a.$t("roleManagement.form.identify"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.identify,"onUpdate:modelValue":o[8]||(o[8]=t=>n.value.identify=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(c,{field:"scopes",label:a.$t("menuManagement.form.scopes")},{default:l(()=>[e(V,{size:"large"},{default:l(()=>[e(ye,{modelValue:n.value.scopes,"onUpdate:modelValue":o[9]||(o[9]=t=>n.value.scopes=t),disabled:!0},{default:l(()=>[e(te,{value:"admin"},{default:l(()=>[g(v(a.$t("roleManagement.form.scopes.admin")),1)]),_:1}),e(te,{value:"member"},{default:l(()=>[g(v(a.$t("roleManagement.form.scopes.member")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),e(c,{field:"sort",label:a.$t("roleManagement.form.sort")},{default:l(()=>[e(_e,{modelValue:n.value.sort,"onUpdate:modelValue":o[10]||(o[10]=t=>n.value.sort=t),placeholder:a.$t("roleManagement.form.placeholder.input"),min:0,mode:"button"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(c,{field:"status",label:a.$t("roleManagement.form.status")},{default:l(()=>[e(D,{modelValue:n.value.status,"onUpdate:modelValue":o[11]||(o[11]=t=>n.value.status=t),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),e(c,{field:"remark",label:a.$t("roleManagement.form.remark")},{default:l(()=>[e(Me,{modelValue:n.value.remark,"onUpdate:modelValue":o[12]||(o[12]=t=>n.value.remark=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(c,null,{default:l(()=>[e(V,null,{default:l(()=>[e(m,{loading:N.value,type:"primary","html-type":"submit"},{default:l(()=>[g(v(a.$t("roleManagement.button.submit")),1)]),_:1},8,["loading"]),e(m,{type:"outline",onClick:o[13]||(o[13]=t=>a.$refs.formRef.resetFields())},{default:l(()=>[g(v(a.$t("roleManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}}));var Ua=je(ca,[["__scopeId","data-v-032a99fa"]]);export{Ua as default};
