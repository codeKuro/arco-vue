var me=Object.defineProperty,ce=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var z=(u,o,r)=>o in u?me(u,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[o]=r,R=(u,o)=>{for(var r in o||(o={}))fe.call(o,r)&&z(u,r,o[r]);if(P)for(var r of P(o))ge.call(o,r)&&z(u,r,o[r]);return u},O=(u,o)=>ce(u,pe(o));import{_ as ve,u as be,t as _e}from"./index.6eb722a8.js";/* empty css               *//* empty css               */import{u as he}from"./loading.28115bcb.js";/* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               */import{d as Me,e as i,r as ye,aJ as $,A as ke,B as $e,aG as t,aF as s,aL as w,aM as V,u as E,bb as we,aR as j,aS as Ve,b3 as Ce,bd as Se,be as Re,bf as je,aQ as Ie,bg as Ue,bj as qe,b0 as Fe,b5 as Ne,b6 as Oe,b4 as Je,aX as Ae,bq as Te,bp as De}from"./arco.bb856b78.js";import{b as Le,q as Be,e as Pe,f as ze,h as Ee,i as Ge}from"./authority.cf7f17f7.js";import"./chart.e89f81b2.js";import"./vue.e8f01861.js";const Ke={class:"container"},Qe={name:"AdministratorsManagement"},Xe=Me(O(R({},Qe),{setup(u){const o=()=>({id:"",username:"",nickname:"",password:"",passwordConfirm:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),r=()=>({id:"",roleIds:""}),v=i(""),{loading:G,setLoading:m}=he(!0),{t:b}=be(),J=i([]),A=i([]),I=i(),n=i(o()),U=i(r()),q=i(!1),_=i(!1),F=i(!1),y=i([]),K=i(!1),C=i(),h=i(!1),T={page:1,size:10},N=ye(R({},T)),Q=[{required:!0,message:b("administratorsManagement.form.placeholder.input")},{validator:(e,a)=>new Promise(c=>{window.setTimeout(()=>{e!==n.value.password&&a(b("administratorsManagement.form.password.confirm.errMsg")),c()},100)})}],M=async(e={page:1,size:10})=>{m(!0);try{const{data:a}=await Le(e);J.value=a.list,N.page=e.page,N.total=a.total}catch(a){v.value=a.message}finally{m(!1)}};(async(e={scopes:"admin"})=>{m(!0);try{const{data:a}=await Be(e);A.value=_e(a.roleList)}catch(a){v.value=a.message}finally{m(!1)}})();const X=e=>{M(O(R({},T),{page:e}))};M();const H=()=>{var e;C.value="add",(e=I.value)==null||e.resetFields(),_.value=!0},W=e=>{var c;C.value="edit";const a=Object.keys(e).reduce((d,f)=>(d[f]={value:e[f]},d),{});(c=I.value)==null||c.setFields(a),_.value=!0},Y=e=>{console.log(y);const a=JSON.parse(JSON.stringify(e));a.roleIds=a.roleIds.split(","),console.log(a.roleIds),y.value=a.roleIds,U.value.id=a.id,F.value=!0},Z=async({errors:e,values:a})=>{if(!e){m(!0),h.value=!0;const c=JSON.parse(JSON.stringify(n.value));if(C.value==="add")try{await Pe(c),j.success(b("administratorsManagement.form.add.success")),M()}catch(d){v.value=d.message}finally{m(!1),h.value=!1,_.value=!1}else try{await ze(c),j.success(b("administratorsManagement.form.edit.success")),M()}catch(d){v.value=d.message}finally{m(!1),h.value=!1,_.value=!1}}},x=async e=>{q.value=!0;try{const{data:a}=await Ee({id:e.id});j.success(b("administratorsManagement.form.edit.success")),M()}catch(a){v.value=a.message}finally{q.value=!1}},ee=async()=>{m(!0),h.value=!0,U.value.roleIds=JSON.parse(JSON.stringify(y.value));const e=JSON.parse(JSON.stringify(U.value));e.roleIds=e.roleIds.toString();try{const{data:a}=await Ge(e);j.success(b("administratorsManagement.form.bind.success")),M()}catch(a){v.value=a.message}finally{m(!1),h.value=!1}};return(e,a)=>{const c=$("icon-plus"),d=Ve,f=Ce,ae=Se,te=Re,g=je,le=$("icon-check"),se=$("icon-close"),D=Ie,ne=$("icon-edit"),oe=$("icon-subscribe-add"),ie=Ue,re=qe,k=Fe,p=Ne,L=Oe,de=Je,B=Ae,ue=Te;return ke(),$e("div",Ke,[t(re,{class:"general-card",style:{"padding-top":"16px"}},{default:s(()=>[t(te,{style:{"margin-bottom":"16px"}},{default:s(()=>[t(ae,{span:16},{default:s(()=>[t(f,null,{default:s(()=>[t(d,{type:"primary",onClick:H},{icon:s(()=>[t(c)]),default:s(()=>[w(" "+V(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(ie,{"row-key":"id",loading:E(G),pagination:E(N),data:J.value,bordered:!1,onPageChange:X},{columns:s(()=>[t(g,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:s(({record:l})=>[t(f,null,{default:s(()=>[t(D,{modelValue:l.status,"onUpdate:modelValue":S=>l.status=S,disabled:l.isSuperRole===1,loading:q.value,"checked-value":1,"unchecked-value":0,onChange:S=>x(l)},{"checked-icon":s(()=>[t(le)]),"unchecked-icon":s(()=>[t(se)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),t(g,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:s(({record:l})=>[t(f,null,{default:s(()=>[t(d,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:S=>W(l)},{icon:s(()=>[t(ne)]),default:s(()=>[w(" "+V(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),t(d,{disabled:l.isSuperRole===1,status:"success",size:"small",onClick:S=>Y(l)},{icon:s(()=>[t(oe)]),default:s(()=>[w(" "+V(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1}),t(B,{visible:_.value,"onUpdate:visible":a[9]||(a[9]=l=>_.value=l),width:"auto",title:C.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:s(()=>[t(de,{ref_key:"formRef",ref:I,model:n.value,style:{width:"600px"},onSubmit:Z},{default:s(()=>[we(t(p,{field:"id"},{default:s(()=>[t(k,{modelValue:n.value.id,"onUpdate:modelValue":a[0]||(a[0]=l=>n.value.id=l)},null,8,["modelValue"])]),_:1},512),[[De,!1]]),t(p,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:s(()=>[t(k,{modelValue:n.value.username,"onUpdate:modelValue":a[1]||(a[1]=l=>n.value.username=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(p,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:s(()=>[t(k,{modelValue:n.value.nickname,"onUpdate:modelValue":a[2]||(a[2]=l=>n.value.nickname=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(p,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:s(()=>[t(L,{modelValue:n.value.password,"onUpdate:modelValue":a[3]||(a[3]=l=>n.value.password=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(p,{field:"passwordConfirm",label:e.$t("administratorsManagement.form.password.confirm"),rules:Q},{default:s(()=>[t(L,{modelValue:n.value.passwordConfirm,"onUpdate:modelValue":a[4]||(a[4]=l=>n.value.passwordConfirm=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(p,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:s(()=>[t(k,{modelValue:n.value.mobile,"onUpdate:modelValue":a[5]||(a[5]=l=>n.value.mobile=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(p,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:s(()=>[t(k,{modelValue:n.value.email,"onUpdate:modelValue":a[6]||(a[6]=l=>n.value.email=l),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),t(p,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:s(()=>[t(D,{modelValue:n.value.status,"onUpdate:modelValue":a[7]||(a[7]=l=>n.value.status=l),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),t(p,null,{default:s(()=>[t(f,null,{default:s(()=>[t(d,{loading:h.value,type:"primary","html-type":"submit"},{default:s(()=>[w(V(e.$t("administratorsManagement.button.submit")),1)]),_:1},8,["loading"]),t(d,{type:"outline",onClick:a[8]||(a[8]=l=>e.$refs.formRef.resetFields())},{default:s(()=>[w(V(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(B,{visible:F.value,"onUpdate:visible":a[11]||(a[11]=l=>F.value=l),title:e.$t("administratorsManagement.form.title.bind"),onOk:ee},{default:s(()=>[t(ue,{"checked-keys":y.value,"onUpdate:checked-keys":a[10]||(a[10]=l=>y.value=l),checkable:!0,"check-strictly":K.value,data:A.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var ua=ve(Xe,[["__scopeId","data-v-6961f13f"]]);export{ua as default};
