var Me=Object.defineProperty,Te=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var ee=(n,t,r)=>t in n?Me(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,V=(n,t)=>{for(var r in t||(t={}))De.call(t,r)&&ee(n,r,t[r]);if(Q)for(var r of Q(t))Ie.call(t,r)&&ee(n,r,t[r]);return n},te=(n,t)=>Te(n,Be(t));import{a as X,c as ne,_ as P,u as se,b as A,cV as je,cW as Fe,cX as Ee,cY as oe,cZ as ae,c_ as Re,c$ as Pe,d0 as ce}from"./index.fd658db6.js";import{F as Ae}from"./index.04e31d8f.js";import{aR as ze,d as j,aJ as B,A as i,aC as y,aF as e,aG as s,E as _,aL as M,aM as w,C as Y,B as D,aH as K,D as O,aD as I,bP as Ue,aI as W,bQ as Ve,bC as re,bD as Ne,b3 as ie,bt as Ke,bI as Oe,bJ as We,bx as qe,bK as He,e as F,r as Je,t as Xe,c as $,u as f,ba as Ye,bh as Ze,aS as le,bi as Ge,bR as Qe,i as et,b7 as ue,b8 as de,bw as tt,bS as nt,bT as st,bU as ot,bV as at,bB as ct,bW as rt,bX as it,h as _e,bY as pe,bZ as lt,b_ as ut,w as fe,b$ as dt,c0 as _t,o as pt,c1 as ft,c2 as gt,by as ge,c3 as vt,c4 as ht,p as yt,bb as mt,bp as bt,c5 as kt,aU as xt,c6 as Ct,c7 as $t}from"./arco.cef754ac.js";import{f as q,h as Lt,i as St,j as wt,k as Mt,l as Tt}from"./vue.ba7251dd.js";/* empty css                *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{u as Bt}from"./index.5cdba46d.js";/* empty css              *//* empty css               *//* empty css                *//* empty css               */import"./chart.ed6b2947.js";function Dt(){const n=q(),t=X();return{logout:async d=>{await t.logout();const p=n.currentRoute.value;ze.success("\u767B\u51FA\u6210\u529F"),n.push({name:d&&typeof d=="string"?d:"login",query:te(V({},n.currentRoute.value.query),{redirect:p.name})})}}}function It(){return ne.post("/api/message/list")}function jt(n){return ne.post("/api/message/read",n)}const Ft=M("\u672A\u5F00\u59CB"),Et=M("\u5DF2\u5F00\u901A"),Rt=M("\u8FDB\u884C\u4E2D"),Pt=M("\u5373\u5C06\u5230\u671F"),At=["onClick"],zt=["src"],Ut={class:"footer-wrap"},Vt={class:"footer-wrap"},Nt=j({props:{renderList:{type:Array,required:!0},unreadCount:{type:Number,default:0}},emits:["itemClick"],setup(n,{emit:t}){const r=n,d=()=>{t("itemClick",[...r.renderList])},p=g=>{g.status||t("itemClick",[g])},l=3;return(g,m)=>{const L=Ve,a=B("icon-desktop"),c=re,v=Ne,b=ie,o=Ke,S=Oe,u=We,C=qe,h=He;return i(),y(h,{bordered:!1},{footer:e(()=>[s(b,{fill:"",size:0,class:Y({"add-border-top":n.renderList.length<l})},{default:e(()=>[_("div",Ut,[s(C,{onClick:d},{default:e(()=>[M(w(g.$t("messageBox.allRead")),1)]),_:1})]),_("div",Vt,[s(C,null,{default:e(()=>[M(w(g.$t("messageBox.viewMore")),1)]),_:1})])]),_:1},8,["class"])]),default:e(()=>[(i(!0),D(W,null,K(n.renderList,k=>(i(),y(u,{key:k.id,"action-layout":"vertical",style:O({opacity:k.status?.5:1})},{extra:e(()=>[k.messageType===0?(i(),y(L,{key:0,color:"gray"},{default:e(()=>[Ft]),_:1})):k.messageType===1?(i(),y(L,{key:1,color:"green"},{default:e(()=>[Et]),_:1})):k.messageType===2?(i(),y(L,{key:2,color:"blue"},{default:e(()=>[Rt]),_:1})):k.messageType===3?(i(),y(L,{key:3,color:"red"},{default:e(()=>[Pt]),_:1})):I("",!0)]),default:e(()=>[_("div",{class:"item-wrap",onClick:E=>p(k)},[s(S,null,Ue({title:e(()=>[s(b,{size:4},{default:e(()=>[_("span",null,w(k.title),1),s(v,{type:"secondary"},{default:e(()=>[M(w(k.subTitle),1)]),_:2},1024)]),_:2},1024)]),description:e(()=>[_("div",null,[s(o,{ellipsis:{rows:1}},{default:e(()=>[M(w(k.content),1)]),_:2},1024),k.type==="message"?(i(),y(v,{key:0,class:"time-text"},{default:e(()=>[M(w(k.time),1)]),_:2},1024)):I("",!0)])]),_:2},[k.avatar?{name:"avatar",fn:e(()=>[s(c,{shape:"circle"},{default:e(()=>[k.avatar?(i(),D("img",{key:0,src:k.avatar},null,8,zt)):(i(),y(a,{key:1}))]),_:2},1024)])}:void 0]),1024)],8,At)]),_:2},1032,["style"]))),128)),n.renderList.length&&n.renderList.length<3?(i(),D("div",{key:0,style:O({height:(l-n.renderList.length)*86+"px"})},null,4)):I("",!0)]),_:1})}}});var Kt=P(Nt,[["__scopeId","data-v-da998396"]]);const Ot=j({setup(n){const{loading:t,setLoading:r}=Bt(!0),d=F("message"),{t:p}=se(),l=Je({renderList:[],messageList:[]});Xe(l);const g=[{key:"message",title:p("messageBox.tab.title.message")},{key:"notice",title:p("messageBox.tab.title.notice")},{key:"todo",title:p("messageBox.tab.title.todo")}];async function m(){r(!0);try{const{data:u}=await It();l.messageList=u}catch{}finally{r(!1)}}async function L(u){const C=u.map(h=>h.id);await jt({ids:C}),m()}const a=$(()=>l.messageList.filter(u=>d.value===u.type)),c=$(()=>a.value.filter(u=>!u.status).length),v=u=>l.messageList.filter(h=>h.type===u&&!h.status),b=u=>{const C=v(u);return C.length?`(${C.length})`:""},o=u=>{a.value.length&&L([...u])},S=()=>{l.messageList=[]};return m(),(u,C)=>{const h=Ye,k=Ze,E=le,x=Ge,R=Qe;return i(),y(R,{style:{display:"block"},loading:f(t)},{default:e(()=>[s(x,{activeKey:d.value,"onUpdate:activeKey":C[0]||(C[0]=T=>d.value=T),type:"rounded","destroy-on-hide":""},{extra:e(()=>[s(E,{type:"text",onClick:S},{default:e(()=>[M(w(u.$t("messageBox.tab.button")),1)]),_:1})]),default:e(()=>[(i(),D(W,null,K(g,T=>s(k,{key:T.key},{title:e(()=>[_("span",null,w(T.title)+w(b(T.key)),1)]),default:e(()=>[f(a).length?I("",!0):(i(),y(h,{key:0,status:"404"},{subtitle:e(()=>[M(w(u.$t("messageBox.noContent")),1)]),_:1})),s(Kt,{"render-list":f(a),"unread-count":f(c),onItemClick:o},null,8,["render-list","unread-count"])]),_:2},1024)),64))]),_:1},8,["activeKey"])]),_:1},8,["loading"])}}});var Wt=P(Ot,[["__scopeId","data-v-cfab683a"]]);const qt=n=>(ue("data-v-b9a902ae"),n=n(),de(),n),Ht={class:"navbar"},Jt={class:"left-side"},Xt=qt(()=>_("img",{alt:"logo",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/dfdba5317c0c20ce20e64fac803d52bc.svg~tplv-49unhts6dw-image.image"},null,-1)),Yt=M(" milimili "),Zt={class:"right-side"},Gt={class:"message-box-trigger"},Qt=["src"],en=j({setup(n){const t=A(),r=X(),{logout:d}=Dt(),{changeLocale:p}=je(),{isFullscreen:l,toggle:g}=Lt(),m=[...Fe],L=$(()=>r.avatar),a=$(()=>t.theme),c=St({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged(x){t.toggleTheme(x)}}),v=wt(c),b=()=>{v()},o=()=>{t.updateSettings({globalSettings:!0})},S=F(),u=F(),C=()=>{const x=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});S.value.dispatchEvent(x)},h=()=>{d()},k=()=>{const x=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});u.value.dispatchEvent(x)},E=et("toggleDrawerMenu");return(x,R)=>{const T=tt,he=B("icon-menu-fold"),H=ie,ye=B("icon-language"),z=le,U=nt,J=st,Z=ot,me=B("icon-moon-fill"),be=B("icon-sun-fill"),ke=B("icon-notification"),xe=at,Ce=ct,$e=B("icon-fullscreen-exit"),Le=B("icon-fullscreen"),G=B("icon-settings"),Se=re,we=B("icon-export");return i(),D("div",Ht,[_("div",Jt,[s(H,null,{default:e(()=>[Xt,s(T,{style:{margin:0,fontSize:"18px"},heading:5},{default:e(()=>[Yt]),_:1}),f(t).device==="mobile"?(i(),y(he,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:f(E)},null,8,["onClick"])):I("",!0)]),_:1})]),_("ul",Zt,[_("li",null,[s(U,{content:x.$t("settings.language")},{default:e(()=>[s(z,{class:"nav-btn",type:"outline",shape:"circle",onClick:k},{icon:e(()=>[s(ye)]),_:1})]),_:1},8,["content"]),s(Z,{trigger:"click",onSelect:f(p)},{content:e(()=>[(i(),D(W,null,K(m,N=>s(J,{key:N.value,value:N.value},{default:e(()=>[M(w(N.label),1)]),_:2},1032,["value"])),64))]),default:e(()=>[_("div",{ref_key:"triggerBtn",ref:u,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),_("li",null,[s(U,{content:f(a)==="light"?x.$t("settings.navbar.theme.toDark"):x.$t("settings.navbar.theme.toLight")},{default:e(()=>[s(z,{class:"nav-btn",type:"outline",shape:"circle",onClick:b},{icon:e(()=>[f(a)==="dark"?(i(),y(me,{key:0})):(i(),y(be,{key:1}))]),_:1})]),_:1},8,["content"])]),_("li",null,[s(U,{content:x.$t("settings.navbar.alerts")},{default:e(()=>[_("div",Gt,[s(xe,{count:9,dot:""},{default:e(()=>[s(z,{class:"nav-btn",type:"outline",shape:"circle",onClick:C},{default:e(()=>[s(ke)]),_:1})]),_:1})])]),_:1},8,["content"]),s(Ce,{trigger:"click","arrow-style":{display:"none"},"content-style":{padding:0,minWidth:"400px"},"content-class":"message-popover"},{content:e(()=>[s(Wt)]),default:e(()=>[_("div",{ref_key:"refBtn",ref:S,class:"ref-btn"},null,512)]),_:1})]),_("li",null,[s(U,{content:f(l)?x.$t("settings.navbar.screen.toExit"):x.$t("settings.navbar.screen.toFull")},{default:e(()=>[s(z,{class:"nav-btn",type:"outline",shape:"circle",onClick:f(g)},{icon:e(()=>[f(l)?(i(),y($e,{key:0})):(i(),y(Le,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),_("li",null,[s(U,{content:x.$t("settings.title")},{default:e(()=>[s(z,{class:"nav-btn",type:"outline",shape:"circle",onClick:o},{icon:e(()=>[s(G)]),_:1})]),_:1},8,["content"])]),_("li",null,[s(Z,{trigger:"click"},{content:e(()=>[s(J,null,{default:e(()=>[s(H,{onClick:R[0]||(R[0]=N=>x.$router.push({name:"Setting"}))},{default:e(()=>[s(G),_("span",null,w(x.$t("messageBox.userSettings")),1)]),_:1})]),_:1}),s(J,null,{default:e(()=>[s(H,{onClick:h},{default:e(()=>[s(we),_("span",null,w(x.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:e(()=>[s(Se,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:e(()=>[_("img",{alt:"avatar",src:f(L)},null,8,Qt)]),_:1})]),_:1})])])])}}});var tn=P(en,[["__scopeId","data-v-b9a902ae"]]);const nn=[...Ee],sn=nn.map(n=>{const{name:t,path:r,meta:d,redirect:p,children:l}=n;return{name:t,path:r,meta:d,redirect:p,children:l}});function on(){const n=oe(),t=A(),r=$(()=>t.menuFromServer?t.appAsyncMenus:sn);return{menuTree:$(()=>{const p=JSON.parse(JSON.stringify(r.value));console.log(p),p.sort((g,m)=>(g.meta.order||0)-(m.meta.order||0));function l(g,m){return g?g.map(a=>{var v,b;if(!n.accessRouter(a))return null;if(((v=a.meta)==null?void 0:v.hideChildrenInMenu)||!a.children)return a.children=[],a;a.children=a.children.filter(o=>{var S;return((S=o.meta)==null?void 0:S.hideInMenu)!==!0});const c=l(a.children,m+1);return c.length||m>1?(a.children=c,a):((b=a.meta)==null?void 0:b.hideInMenu)===!1?a:null}).filter(Boolean):null}return l(p,0)})}}function an(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!rt(n)}var cn=j({emit:["collapse"],setup(){const{t:n}=se(),t=A(),r=q(),{menuTree:d}=on(),p=$({get(){return t.device==="desktop"?t.menuCollapse:!1},set(c){t.updateSettings({menuCollapse:c})}}),l=F([]),g=F([]),m=c=>{if(Re.test(c.path)){Pe(c.path),g.value=[c.name];return}r.push({name:c.name})};ae(c=>{var v;if(c.meta.requiresAuth&&!c.meta.hideInMenu){const{matched:b}=c;if(b.length>1&&b.slice(0,b.length-1).forEach(({name:o})=>{l.value.includes(o)||l.value.push(o)}),c.meta.activeMenu)g.value=[c.meta.activeMenu];else{const o=(v=b[b.length-1])==null?void 0:v.name;g.value=[o]}}},!0);const L=c=>{t.device==="desktop"&&t.updateSettings({menuCollapse:c})},a=()=>{function c(v,b=[]){return v&&v.forEach(o=>{var C;const S=((C=o==null?void 0:o.meta)==null?void 0:C.icon)?()=>{var h;return _e(pe(`<${(h=o==null?void 0:o.meta)==null?void 0:h.icon}/>`))}:null,u=(o==null?void 0:o.children)&&(o==null?void 0:o.children.length)!==0?s(lt,{key:o==null?void 0:o.name},{default:()=>[c(o==null?void 0:o.children)],icon:S,title:()=>{var h;return _e(pe(n(((h=o==null?void 0:o.meta)==null?void 0:h.locale)||"")))}}):s(ut,{key:o==null?void 0:o.name,onClick:()=>m(o)},{default:()=>{var h;return[n(((h=o==null?void 0:o.meta)==null?void 0:h.locale)||"")]},icon:S});b.push(u)}),b}return c(d.value)};return()=>{let c;return s(it,{collapsed:p.value,"onUpdate:collapsed":v=>p.value=v,"open-keys":l.value,"onUpdate:open-keys":v=>l.value=v,"show-collapse-button":t.device!=="mobile","auto-open":!1,"selected-keys":g.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%",onCollapse:L},an(c=a())?c:{default:()=>[c]})}}});var ve=P(cn,[["__scopeId","data-v-72f098ca"]]);const rn=n=>(ue("data-v-4e2b11ca"),n=n(),de(),n),ln={class:"tab-bar-container"},un={class:"tab-bar-box"},dn={class:"tab-bar-scroll"},_n={class:"tags-wrap"},pn=["onClick"],fn={class:"tag-link"},gn=["onClick"],vn=rn(()=>_("div",{class:"tag-bar-operation"},null,-1)),hn=j({setup(n){const t=A(),r=ce(),d=q(),p=F(),l=$(()=>r.getTabList),g=$(()=>t.navbar?60:0);fe(()=>t.navbar,()=>{p.value.updatePosition()}),ae(a=>{!a.meta.noAffix&&!l.value.some(c=>c.fullPath===a.fullPath)&&r.updateTabList(a)},!0);const m=(a,c)=>{if(r.deleteTag(c,a),c===l.value.length){const v=l.value[l.value.length-1];d.push({name:v.name})}},L=a=>{d.push(V({},a))};return(a,c)=>{const v=B("icon-close"),b=_t;return i(),D("div",ln,[s(b,{ref_key:"affixRef",ref:p,"offset-top":f(g)},{default:e(()=>[_("div",un,[_("div",dn,[_("div",_n,[(i(!0),D(W,null,K(f(l),(o,S)=>(i(),D("span",{key:o.fullPath,class:Y(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":o.fullPath===a.$route.fullPath}]),onClick:u=>L(o)},[_("span",fn,w(a.$t(o.title)),1),_("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:dt(u=>m(o,S),["stop"])},[s(v)],8,gn)],10,pn))),128))])]),vn])]),_:1},8,["offset-top"])])}}});var yn=P(hn,[["__scopeId","data-v-4e2b11ca"]]);function mn(n,t,r,d=!1){n.addEventListener&&typeof n.addEventListener=="function"&&n.addEventListener(t,r,d)}function bn(n,t,r,d=!1){n.removeEventListener&&typeof n.removeEventListener=="function"&&n.removeEventListener(t,r,d)}const kn=992;function xn(){return document.body.getBoundingClientRect().width-1<kn}function Cn(n){const t=A();function r(){if(!document.hidden){const p=xn();t.toggleDevice(p?"mobile":"desktop"),t.toggleMenu(p)}}const d=Mt(r,100);pt(()=>{n&&d()}),ft(()=>{mn(window,"resize",d)}),gt(()=>{bn(window,"resize",d)})}const $n=j({setup(n){const t=ce(),r=$(()=>t.getCacheList);return(d,p)=>{const l=B("router-view");return i(),y(l,null,{default:e(({Component:g,route:m})=>[s(ht,{name:"fade",mode:"out-in",appear:""},{default:e(()=>[m.meta.ignoreCache?(i(),y(ge(g),{key:m.fullPath})):(i(),y(vt,{key:1,include:f(r)},[(i(),y(ge(g),{key:m.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}});const Ln={key:0,class:"layout-navbar"},Sn={class:"menu-wrapper"},wn=j({setup(n){const t=A(),r=X(),d=q(),p=Tt(),l=oe();Cn(!0);const g="60px",m=$(()=>t.navbar),L=$(()=>t.menu),a=$(()=>t.hideMenu),c=$(()=>t.footer),v=$(()=>t.menuCollapse?48:t.menuWidth),b=$(()=>t.menuCollapse),o=$(()=>{const h=L.value&&!a.value?{paddingLeft:`${v.value}px`}:{},k=m.value?{paddingTop:g}:{};return V(V({},h),k)}),S=h=>{t.updateSettings({menuCollapse:h})};fe(()=>r.role,h=>{h&&!l.accessRouter(p)&&d.push({name:"notFound"})});const u=F(!1),C=()=>{u.value=!1};return yt("toggleDrawerMenu",()=>{u.value=!u.value}),(h,k)=>{const E=kt,x=xt,R=Ct,T=$t;return i(),y(T,{class:Y(["layout",{mobile:f(t).hideMenu}])},{default:e(()=>[f(m)?(i(),D("div",Ln,[s(tn)])):I("",!0),s(T,null,{default:e(()=>[s(T,null,{default:e(()=>[f(L)?mt((i(),y(E,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:f(b),collapsible:!0,width:f(v),style:O({paddingTop:f(m)?"60px":""}),"hide-trigger":!0,onCollapse:S},{default:e(()=>[_("div",Sn,[s(ve)])]),_:1},8,["collapsed","width","style"])),[[bt,!f(a)]]):I("",!0),f(a)?(i(),y(x,{key:1,visible:u.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:C},{default:e(()=>[s(ve)]),_:1},8,["visible"])):I("",!0),s(T,{class:"layout-content",style:O(f(o))},{default:e(()=>[f(t).tabBar?(i(),y(yn,{key:0})):I("",!0),s(R,null,{default:e(()=>[s($n)]),_:1}),f(c)?(i(),y(Ae,{key:1})):I("",!0)]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}});var qn=P(wn,[["__scopeId","data-v-5424861c"]]);export{qn as default};
