var he=Object.defineProperty,ke=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ne=(g,s,d)=>s in g?he(g,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):g[s]=d,se=(g,s)=>{for(var d in s||(s={}))we.call(s,d)&&ne(g,d,s[d]);if(oe)for(var d of oe(s))Ce.call(s,d)&&ne(g,d,s[d]);return g},de=(g,s)=>ke(g,Ve(s));import{_ as je,u as Re,t as Se}from"./index.66d117c3.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css               *//* empty css                */import{q as Ue}from"./serve.b2956b0b.js";/* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css               */import{d as Ie,e as p,r as Ne,c as Te,aJ as $,A as R,B as Ae,aG as e,aF as l,aC as A,aL as i,aM as u,aD as q,u as S,bb as qe,aR as F,aS as Fe,bc as Ke,b3 as Be,bd as De,be as Le,bf as Oe,aQ as ze,bg as Je,bh as Pe,bi as Ee,bj as Ge,bk as He,b5 as Qe,b0 as Xe,bl as We,bm as Ye,bn as Ze,aP as xe,bo as ea,b4 as aa,aX as la,bp as ta}from"./arco.a53b75be.js";import{u as oa}from"./loading.c387c5f5.js";import{q as na,d as sa,g as da,c as ra,u as ia,a as ua}from"./authority.dfda2478.js";import"./chart.da3854a0.js";import"./vue.0de19953.js";const ma={class:"container"},ca={name:"RoleManagement"},pa=Ie(de(se({},ca),{setup(g){const s=()=>({id:"",type:1,appName:"",name:"",identify:"",remark:"",status:0,sort:0,scopes:"admin",createdAt:"",isSupperRole:0,nodeIds:""}),d=p(""),{loading:O,setLoading:b}=oa(!0),{t:h}=Re(),y=p("1"),K=p([]),B=p(),n=p(s()),U=p(!1),k=p(!1),C=p(!1),I=p(),_=p([]),z=Ne({type:"checkbox",showCheckedAll:!0,checkStrictly:!0}),J=p([]),N=p(!1),re=Te(()=>[{label:h("roleManagement.form.type.1"),value:1},{label:h("roleManagement.form.type.2"),value:2}]),V=async(a=y.value==="1"?{scopes:"admin"}:{scopes:"member"})=>{b(!0);try{const{data:o}=await na(a),m=await Ue(a);K.value=o.roleList,J.value=Se(m.data.nodeTree)}catch{}finally{b(!1)}};V();const ie=a=>{y.value=a,V()},P=()=>{var a;I.value="add",(a=B.value)==null||a.resetFields(),y.value==="1"?n.value.scopes="admin":n.value.scopes="member",k.value=!0},E=()=>{console.log(_),_.value.length?C.value=!0:F.error(h("roleManagement.button.confirmation.deleteAll"))},G=async(a={ids:_.value})=>{b(!0);try{await sa(a),V()}catch(o){d.value=o.message}finally{b(!1),C.value=!1}},H=()=>{C.value=!1},Q=async a=>{var o;b(!0),I.value="edit";try{const{data:m}=await da({id:a.id}),v=Object.keys(m).reduce((c,j)=>(c[j]={value:m[j]},c),{});v.nodeIds.value=v.nodeIds.value.split(","),(o=B.value)==null||o.setFields(v),k.value=!0}catch{}finally{b(!1)}},ue=async({errors:a,values:o})=>{if(!a){b(!0),N.value=!0;const m=JSON.parse(JSON.stringify(n.value));if(console.log(n.value),m.nodeIds=m.nodeIds.toString(),I.value==="add")try{await ra(m),F.success(h("roleManagement.form.add.success")),N.value=!1,V()}catch(v){d.value=v.message}finally{b(!1),k.value=!1}else try{await ia(m),F.success(h("roleManagement.form.edit.success")),N.value=!1,V()}catch(v){d.value=v.message}finally{b(!1),k.value=!1}}},X=async a=>{U.value=!0;try{const{data:o}=await ua({id:a.id});F.success(h("roleManagement.form.edit.success")),V()}catch{}finally{U.value=!1}};function me(){console.log(n)}return(a,o)=>{const m=$("Breadcrumb"),v=$("icon-plus"),c=Fe,j=$("icon-delete"),W=Ke,w=Be,D=De,Y=Le,r=Oe,Z=$("icon-check"),x=$("icon-close"),L=ze,ee=$("icon-edit"),ae=Je,le=Pe,ce=$("icon-download"),pe=Ee,fe=Ge,ge=He,f=Qe,T=Xe,ve=We,te=Ye,be=Ze,ye=xe,_e=ea,Me=aa,$e=la;return R(),Ae("div",ma,[e(m,{items:["menu.authority","menu.authority.roleManagement"]},null,8,["items"]),e(fe,{class:"general-card",title:a.$t("menu.authority.roleManagement")},{default:l(()=>[e(pe,{modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=t=>y.value=t),"default-active-key":"1",onChange:ie},{default:l(()=>[e(le,{key:"1",title:a.$t("menu.card.tabOne")},{default:l(()=>[y.value==1?(R(),A(Y,{key:0,style:{"margin-bottom":"16px"}},{default:l(()=>[e(D,{span:16},{default:l(()=>[e(w,null,{default:l(()=>[e(c,{type:"primary",onClick:P},{icon:l(()=>[e(v)]),default:l(()=>[i(" "+u(a.$t("roleManagement.operation.create")),1)]),_:1}),e(W,{"popup-visible":C.value,content:a.$t("roleManagement.button.confirmation.delete"),onOk:G,onCancel:H},{default:l(()=>[e(c,{type:"primary",onClick:E},{icon:l(()=>[e(j)]),default:l(()=>[i(" "+u(a.$t("roleManagement.operation.delete")),1)]),_:1})]),_:1},8,["popup-visible","content"])]),_:1})]),_:1})]),_:1})):q("",!0),y.value==1?(R(),A(ae,{key:1,selectedKeys:_.value,"onUpdate:selectedKeys":o[0]||(o[0]=t=>_.value=t),"row-key":"id",loading:S(O),data:K.value,bordered:!1,"row-selection":S(z),pagination:!1},{columns:l(()=>[e(r,{title:a.$t("roleManagement.columns.type"),"data-index":"type"},{cell:l(({record:t})=>[i(u(a.$t(`roleManagement.form.type.${t.type}`)),1)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.id"),"data-index":"id"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.name"),"data-index":"name"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.identify"),"data-index":"identify"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.createdAt"),"data-index":"createdAt"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.status"),"data-index":"status"},{cell:l(({record:t})=>[e(w,null,{default:l(()=>[e(L,{modelValue:t.status,"onUpdate:modelValue":M=>t.status=M,disabled:t.id==="1",loading:U.value,"checked-value":1,"unchecked-value":0,onChange:M=>X(t)},{"checked-icon":l(()=>[e(Z)]),"unchecked-icon":l(()=>[e(x)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.operations"),"data-index":"operations"},{cell:l(({record:t})=>[e(c,{disabled:t.identify==="super_admin",status:"success",size:"small",onClick:M=>Q(t)},{icon:l(()=>[e(ee)]),default:l(()=>[i(" "+u(a.$t("roleManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["selectedKeys","loading","data","row-selection"])):q("",!0)]),_:1},8,["title"]),e(le,{key:"2",title:a.$t("menu.card.tabTwo")},{default:l(()=>[y.value==2?(R(),A(Y,{key:0,style:{"margin-bottom":"16px"}},{default:l(()=>[e(D,{span:16},{default:l(()=>[e(w,null,{default:l(()=>[e(c,{type:"primary",onClick:P},{icon:l(()=>[e(v)]),default:l(()=>[i(" "+u(a.$t("roleManagement.operation.create")),1)]),_:1}),e(W,{"popup-visible":C.value,content:a.$t("roleManagement.button.confirmation.delete"),onOk:G,onCancel:H},{default:l(()=>[e(c,{type:"primary",onClick:E},{icon:l(()=>[e(j)]),default:l(()=>[i(" "+u(a.$t("roleManagement.operation.delete")),1)]),_:1})]),_:1},8,["popup-visible","content"])]),_:1})]),_:1}),e(D,{span:8,style:{"text-align":"right"}},{default:l(()=>[e(c,null,{icon:l(()=>[e(ce)]),default:l(()=>[i(" "+u(a.$t("roleManagement.operation.download")),1)]),_:1})]),_:1})]),_:1})):q("",!0),y.value==2?(R(),A(ae,{key:1,selectedKeys:_.value,"onUpdate:selectedKeys":o[1]||(o[1]=t=>_.value=t),"row-key":"id",loading:S(O),data:K.value,bordered:!1,"row-selection":S(z),pagination:!1},{columns:l(()=>[e(r,{title:a.$t("roleManagement.columns.type"),"data-index":"type"},{cell:l(({record:t})=>[i(u(a.$t(`roleManagement.form.type.${t.type}`)),1)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.id"),"data-index":"id"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.name"),"data-index":"name"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.identify"),"data-index":"identify"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.createdAt"),"data-index":"createdAt"},null,8,["title"]),e(r,{title:a.$t("roleManagement.columns.status"),"data-index":"status"},{cell:l(({record:t})=>[e(w,null,{default:l(()=>[e(L,{modelValue:t.status,"onUpdate:modelValue":M=>t.status=M,disabled:t.identify==="super_admin",loading:U.value,"checked-value":1,"unchecked-value":0,onChange:M=>X(t)},{"checked-icon":l(()=>[e(Z)]),"unchecked-icon":l(()=>[e(x)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),e(r,{title:a.$t("roleManagement.columns.operations"),"data-index":"operations"},{cell:l(({record:t})=>[e(c,{disabled:t.identify==="super_admin",status:"success",size:"small",onClick:M=>Q(t)},{icon:l(()=>[e(ee)]),default:l(()=>[i(" "+u(a.$t("roleManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"])]),_:1},8,["title"])]),_:1},8,["selectedKeys","loading","data","row-selection"])):q("",!0)]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1},8,["title"]),e($e,{visible:k.value,"onUpdate:visible":o[14]||(o[14]=t=>k.value=t),width:"auto",title:I.value==="add"?a.$t("roleManagement.form.title.add"):a.$t("roleManagement.form.title.edit"),footer:!1},{default:l(()=>[e(Me,{ref_key:"formRef",ref:B,model:n.value,style:{width:"600px"},onSubmit:ue},{default:l(()=>[e(f,{field:"type",label:a.$t("roleManagement.form.type"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.select")}]},{default:l(()=>[e(ge,{modelValue:n.value.type,"onUpdate:modelValue":o[3]||(o[3]=t=>n.value.type=t),options:S(re),placeholder:a.$t("roleManagement.form.placeholder.select")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label","rules"]),qe(e(f,{field:"id"},{default:l(()=>[e(T,{modelValue:n.value.id,"onUpdate:modelValue":o[4]||(o[4]=t=>n.value.id=t)},null,8,["modelValue"])]),_:1},512),[[ta,!1]]),e(f,{field:"name",label:a.$t("roleManagement.form.name"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.name,"onUpdate:modelValue":o[5]||(o[5]=t=>n.value.name=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(f,{field:"appName",label:a.$t("roleManagement.form.appName"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.appName,"onUpdate:modelValue":o[6]||(o[6]=t=>n.value.appName=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(f,{field:"nodeIds",label:a.$t("roleManagement.form.nodeIds"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.select")}]},{default:l(()=>[e(ve,{modelValue:n.value.nodeIds,"onUpdate:modelValue":o[7]||(o[7]=t=>n.value.nodeIds=t),"allow-search":!0,"allow-clear":!0,"tree-checkable":!0,"tree-check-strictly":!0,"max-tag-count":4,data:J.value,placeholder:a.$t("roleManagement.form.placeholder.select"),"dropdown-style":{minHeight:"300px",overflow:"auto"},onChange:me},null,8,["modelValue","data","placeholder"])]),_:1},8,["label","rules"]),e(f,{field:"identify",label:a.$t("roleManagement.form.identify"),rules:[{required:!0,message:a.$t("roleManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[e(T,{modelValue:n.value.identify,"onUpdate:modelValue":o[8]||(o[8]=t=>n.value.identify=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),e(f,{field:"scopes",label:a.$t("menuManagement.form.scopes")},{default:l(()=>[e(w,{size:"large"},{default:l(()=>[e(be,{modelValue:n.value.scopes,"onUpdate:modelValue":o[9]||(o[9]=t=>n.value.scopes=t),disabled:!0},{default:l(()=>[e(te,{value:"admin"},{default:l(()=>[i(u(a.$t("roleManagement.form.scopes.admin")),1)]),_:1}),e(te,{value:"member"},{default:l(()=>[i(u(a.$t("roleManagement.form.scopes.member")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["label"]),e(f,{field:"sort",label:a.$t("roleManagement.form.sort")},{default:l(()=>[e(ye,{modelValue:n.value.sort,"onUpdate:modelValue":o[10]||(o[10]=t=>n.value.sort=t),placeholder:a.$t("roleManagement.form.placeholder.input"),min:0,mode:"button"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(f,{field:"status",label:a.$t("roleManagement.form.status")},{default:l(()=>[e(L,{modelValue:n.value.status,"onUpdate:modelValue":o[11]||(o[11]=t=>n.value.status=t),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),e(f,{field:"remark",label:a.$t("roleManagement.form.remark")},{default:l(()=>[e(_e,{modelValue:n.value.remark,"onUpdate:modelValue":o[12]||(o[12]=t=>n.value.remark=t),placeholder:a.$t("roleManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(f,null,{default:l(()=>[e(w,null,{default:l(()=>[e(c,{loading:N.value,type:"primary","html-type":"submit"},{default:l(()=>[i(u(a.$t("roleManagement.button.submit")),1)]),_:1},8,["loading"]),e(c,{type:"outline",onClick:o[13]||(o[13]=t=>a.$refs.formRef.resetFields())},{default:l(()=>[i(u(a.$t("roleManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}}));var Fa=je(pa,[["__scopeId","data-v-a75e22fe"]]);export{Fa as default};
