var ce=Object.defineProperty,pe=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var E=(d,o,r)=>o in d?ce(d,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[o]=r,j=(d,o)=>{for(var r in o||(o={}))ge.call(o,r)&&E(d,r,o[r]);if(z)for(var r of z(o))ve.call(o,r)&&E(d,r,o[r]);return d},O=(d,o)=>pe(d,fe(o));import{_ as be,u as _e,t as he}from"./index.97a7fd5a.js";/* empty css               *//* empty css               */import{u as Me}from"./index.5cdba46d.js";/* empty css              *//* empty css               *//* empty css               *//* empty css              *//* empty css              *//* empty css               */import{d as ye,e as i,r as ke,aJ as M,A as $e,B as we,aG as a,aF as l,aL as $,aM as w,u as G,bb as Ve,aR as R,aS as Ce,b3 as Se,bd as je,be as Re,bf as Ie,aQ as Ue,bg as qe,bj as Fe,b0 as Ne,b5 as Oe,b6 as Je,b4 as Ae,aX as Be,bq as Te,bp as De}from"./arco.cef754ac.js";import{b as Le,q as Pe,e as ze,f as Ee,h as Ge,i as Ke}from"./authority.cd73c543.js";import"./chart.ed6b2947.js";import"./vue.ba7251dd.js";const Qe={class:"container"},Xe={name:"AdministratorsManagement"},He=ye(O(j({},Xe),{setup(d){const o=()=>({id:"",username:"",nickname:"",password:"",passwordConfirm:"",mobile:"",email:"",avatar:"",roleIds:"",status:0}),r=()=>({id:"",roleIds:""}),J=i(""),{loading:K,setLoading:u}=Me(!0),{t:v}=_e(),A=i([]),B=i([]),I=i(),s=i(o()),U=i(r()),q=i(!1),b=i(!1),F=i(!1),y=i([]),Q=i(!1),V=i(),_=i(!1),T={page:1,size:10},N=ke(j({},T)),X=[{required:!0,message:v("administratorsManagement.form.placeholder.input")},{validator:(e,t)=>new Promise(m=>{window.setTimeout(()=>{e!==s.value.password&&t(v("administratorsManagement.form.password.confirm.errMsg")),m()},100)})}],h=async(e={page:1,size:10})=>{u(!0);try{const{data:t}=await Le(e);A.value=t.list,N.page=e.page,N.total=t.total}catch{}finally{u(!1)}};(async(e={scopes:"admin"})=>{u(!0);try{const{data:t}=await Pe(e);B.value=he(t.roleList)}catch{}finally{u(!1)}})();const H=e=>{h(O(j({},T),{page:e}))};h();const W=()=>{var e;V.value="add",(e=I.value)==null||e.resetFields(),b.value=!0},Y=e=>{var m;V.value="edit";const t=Object.keys(e).reduce((p,f)=>(p[f]={value:e[f]},p),{});(m=I.value)==null||m.setFields(t),b.value=!0},Z=e=>{console.log(y);const t=JSON.parse(JSON.stringify(e));t.roleIds=t.roleIds.split(","),console.log(t.roleIds),y.value=t.roleIds,U.value.id=t.id,F.value=!0},x=async({errors:e,values:t})=>{if(!e){u(!0),_.value=!0;const m=JSON.parse(JSON.stringify(s.value));if(V.value==="add")try{await ze(m),R.success(v("administratorsManagement.form.add.success")),h()}catch(p){J.value=p.message}finally{u(!1),_.value=!1,b.value=!1}else try{await Ee(m),R.success(v("administratorsManagement.form.edit.success")),h()}catch(p){J.value=p.message}finally{u(!1),_.value=!1,b.value=!1}}},ee=async e=>{q.value=!0;try{const{data:t}=await Ge({id:e.id});R.success(v("administratorsManagement.form.edit.success")),h()}catch{}finally{q.value=!1}},ae=async()=>{u(!0),_.value=!0,U.value.roleIds=JSON.parse(JSON.stringify(y.value));const e=JSON.parse(JSON.stringify(U.value));e.roleIds=e.roleIds.toString();try{const{data:t}=await Ke(e);R.success(v("administratorsManagement.form.bind.success")),h()}catch{}finally{u(!1),_.value=!1}};return(e,t)=>{const m=M("Breadcrumb"),p=M("icon-plus"),f=Ce,C=Se,te=je,ne=Re,g=Ie,le=M("icon-check"),se=M("icon-close"),D=Ue,oe=M("icon-edit"),ie=M("icon-subscribe-add"),re=qe,de=Fe,k=Ne,c=Oe,L=Je,ue=Ae,P=Be,me=Te;return $e(),we("div",Qe,[a(m,{items:["menu.authority","menu.authority.administratorsManagement"]},null,8,["items"]),a(de,{class:"general-card",title:e.$t("menu.authority.administratorsManagement")},{default:l(()=>[a(ne,{style:{"margin-bottom":"16px"}},{default:l(()=>[a(te,{span:16},{default:l(()=>[a(C,null,{default:l(()=>[a(f,{type:"primary",onClick:W},{icon:l(()=>[a(p)]),default:l(()=>[$(" "+w(e.$t("administratorsManagement.operation.create")),1)]),_:1})]),_:1})]),_:1})]),_:1}),a(re,{"row-key":"id",loading:G(K),pagination:G(N),data:A.value,bordered:!1,onPageChange:H},{columns:l(()=>[a(g,{title:e.$t("administratorsManagement.columns.id"),"data-index":"id"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.username"),"data-index":"username"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.nickname"),"data-index":"nickname"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.mobile"),"data-index":"mobile"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.email"),"data-index":"email"},null,8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.status"),"data-index":"status"},{cell:l(({record:n})=>[a(C,null,{default:l(()=>[a(D,{modelValue:n.status,"onUpdate:modelValue":S=>n.status=S,disabled:n.isSuperRole===1,loading:q.value,"checked-value":1,"unchecked-value":0,onChange:S=>ee(n)},{"checked-icon":l(()=>[a(le)]),"unchecked-icon":l(()=>[a(se)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled","loading","onChange"])]),_:2},1024)]),_:1},8,["title"]),a(g,{title:e.$t("administratorsManagement.columns.operations"),align:"center","data-index":"operations"},{cell:l(({record:n})=>[a(C,null,{default:l(()=>[a(f,{disabled:n.isSuperRole===1,status:"success",size:"small",onClick:S=>Y(n)},{icon:l(()=>[a(oe)]),default:l(()=>[$(" "+w(e.$t("administratorsManagement.columns.operations.edit")),1)]),_:2},1032,["disabled","onClick"]),a(f,{disabled:n.isSuperRole===1,status:"success",size:"small",onClick:S=>Z(n)},{icon:l(()=>[a(ie)]),default:l(()=>[$(" "+w(e.$t("administratorsManagement.columns.operations.roleBand")),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1},8,["title"])]),_:1},8,["loading","pagination","data"])]),_:1},8,["title"]),a(P,{visible:b.value,"onUpdate:visible":t[9]||(t[9]=n=>b.value=n),width:"auto",title:V.value==="add"?e.$t("administratorsManagement.form.title.add"):e.$t("administratorsManagement.form.title.edit"),footer:!1},{default:l(()=>[a(ue,{ref_key:"formRef",ref:I,model:s.value,style:{width:"600px"},onSubmit:x},{default:l(()=>[Ve(a(c,{field:"id"},{default:l(()=>[a(k,{modelValue:s.value.id,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.id=n)},null,8,["modelValue"])]),_:1},512),[[De,!1]]),a(c,{field:"username",label:e.$t("administratorsManagement.form.username"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(k,{modelValue:s.value.username,"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.username=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(c,{field:"nickname",label:e.$t("administratorsManagement.form.nickname"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(k,{modelValue:s.value.nickname,"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.nickname=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(c,{field:"password",label:e.$t("administratorsManagement.form.password"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(L,{modelValue:s.value.password,"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.password=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(c,{field:"passwordConfirm",label:e.$t("administratorsManagement.form.password.confirm"),rules:X},{default:l(()=>[a(L,{modelValue:s.value.passwordConfirm,"onUpdate:modelValue":t[4]||(t[4]=n=>s.value.passwordConfirm=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(c,{field:"mobile",label:e.$t("administratorsManagement.form.mobile"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(k,{modelValue:s.value.mobile,"onUpdate:modelValue":t[5]||(t[5]=n=>s.value.mobile=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(c,{field:"email",label:e.$t("administratorsManagement.form.email"),rules:[{required:!0,message:e.$t("administratorsManagement.form.placeholder.input")}],"validate-trigger":["change","input"]},{default:l(()=>[a(k,{modelValue:s.value.email,"onUpdate:modelValue":t[6]||(t[6]=n=>s.value.email=n),placeholder:e.$t("administratorsManagement.form.placeholder.input")},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"]),a(c,{field:"status",label:e.$t("administratorsManagement.form.status")},{default:l(()=>[a(D,{modelValue:s.value.status,"onUpdate:modelValue":t[7]||(t[7]=n=>s.value.status=n),"checked-value":1,"unchecked-value":0},null,8,["modelValue"])]),_:1},8,["label"]),a(c,null,{default:l(()=>[a(C,null,{default:l(()=>[a(f,{loading:_.value,type:"primary","html-type":"submit"},{default:l(()=>[$(w(e.$t("administratorsManagement.button.submit")),1)]),_:1},8,["loading"]),a(f,{type:"outline",onClick:t[8]||(t[8]=n=>e.$refs.formRef.resetFields())},{default:l(()=>[$(w(e.$t("administratorsManagement.button.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),a(P,{visible:F.value,"onUpdate:visible":t[11]||(t[11]=n=>F.value=n),title:e.$t("administratorsManagement.form.title.bind"),onOk:ae},{default:l(()=>[a(me,{"checked-keys":y.value,"onUpdate:checked-keys":t[10]||(t[10]=n=>y.value=n),checkable:!0,"check-strictly":Q.value,data:B.value},null,8,["checked-keys","check-strictly","data"])]),_:1},8,["visible","title"])])}}}));var ca=be(He,[["__scopeId","data-v-5b48fdc6"]]);export{ca as default};
