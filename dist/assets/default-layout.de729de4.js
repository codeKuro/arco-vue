var Le=Object.defineProperty,we=Object.defineProperties;var xe=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var ee=(n,t,r)=>t in n?Le(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,U=(n,t)=>{for(var r in t||(t={}))Se.call(t,r)&&ee(n,r,t[r]);if(Y)for(var r of Y(t))Me.call(t,r)&&ee(n,r,t[r]);return n},te=(n,t)=>we(n,xe(t));import{Z as O,R as Be,d as F,e as s,o as i,c as m,w as e,f as o,L as p,i as B,t as M,b9 as Q,g as D,h as q,a as K,b as I,bj as Te,F as W,r as E,O as ne,$ as De,bk as Ie,Q as w,u as g,bl as Fe,bm as Ee,be as Re,bn as ze,a0 as oe,a1 as ae,bo as Ae,ba as se,bb as ce,bi as le,bp as Pe,bq as je,br as Ne,bs as Ue,bt as Ve,b8 as re,bc as Oe,bu as qe,bv as Ke,bw as We,a2 as He,a3 as Je}from"./vendor.e6e9099f.js";import{u as Z,_ as A,a as P,c as Qe,L as Ze,d as Ge,e as ie,l as ue,r as Xe,o as Ye,f as de}from"./index.525cc014.js";import{a as et,s as tt}from"./message.39e52c51.js";import{u as nt}from"./loading.3e447ed2.js";import{F as ot}from"./index.288ad9ed.js";function at(){const n=O(),t=Z();return{logout:async _=>{await t.logout();const f=n.currentRoute.value;Be.success("\u767B\u51FA\u6210\u529F"),n.push({name:_&&typeof _=="string"?_:"login",query:te(U({},n.currentRoute.value.query),{redirect:f.name})})}}}const st=B("\u672A\u5F00\u59CB"),ct=B("\u5DF2\u5F00\u901A"),lt=B("\u8FDB\u884C\u4E2D"),rt=B("\u5373\u5C06\u5230\u671F"),it=["onClick"],ut=["src"],dt={class:"footer-wrap"},_t={class:"footer-wrap"},pt=F({props:{renderList:{type:Array,required:!0},unreadCount:{type:Number,default:0}},emits:["itemClick"],setup(n,{emit:t}){const r=n,_=()=>{t("itemClick",[...r.renderList])},f=v=>{v.status||t("itemClick",[v])},u=3;return(v,b)=>{const x=s("a-tag"),c=s("icon-desktop"),l=s("a-avatar"),h=s("a-typography-text"),k=s("a-space"),a=s("a-typography-paragraph"),S=s("a-list-item-meta"),d=s("a-list-item"),L=s("a-link"),y=s("a-list");return i(),m(y,{bordered:!1},{footer:e(()=>[o(k,{fill:"",size:0,class:Q({"add-border-top":n.renderList.length<u})},{default:e(()=>[p("div",dt,[o(L,{onClick:_},{default:e(()=>[B(M(v.$t("messageBox.allRead")),1)]),_:1})]),p("div",_t,[o(L,null,{default:e(()=>[B(M(v.$t("messageBox.viewMore")),1)]),_:1})])]),_:1},8,["class"])]),default:e(()=>[(i(!0),D(W,null,q(n.renderList,C=>(i(),m(d,{key:C.id,"action-layout":"vertical",style:K({opacity:C.status?.5:1})},{extra:e(()=>[C.messageType===0?(i(),m(x,{key:0,color:"gray"},{default:e(()=>[st]),_:1})):C.messageType===1?(i(),m(x,{key:1,color:"green"},{default:e(()=>[ct]),_:1})):C.messageType===2?(i(),m(x,{key:2,color:"blue"},{default:e(()=>[lt]),_:1})):C.messageType===3?(i(),m(x,{key:3,color:"red"},{default:e(()=>[rt]),_:1})):I("",!0)]),default:e(()=>[p("div",{class:"item-wrap",onClick:R=>f(C)},[o(S,null,Te({title:e(()=>[o(k,{size:4},{default:e(()=>[p("span",null,M(C.title),1),o(h,{type:"secondary"},{default:e(()=>[B(M(C.subTitle),1)]),_:2},1024)]),_:2},1024)]),description:e(()=>[p("div",null,[o(a,{ellipsis:{rows:1}},{default:e(()=>[B(M(C.content),1)]),_:2},1024),C.type==="message"?(i(),m(h,{key:0,class:"time-text"},{default:e(()=>[B(M(C.time),1)]),_:2},1024)):I("",!0)])]),_:2},[C.avatar?{name:"avatar",fn:e(()=>[o(l,{shape:"circle"},{default:e(()=>[C.avatar?(i(),D("img",{key:0,src:C.avatar},null,8,ut)):(i(),m(c,{key:1}))]),_:2},1024)])}:void 0]),1024)],8,it)]),_:2},1032,["style"]))),128)),n.renderList.length&&n.renderList.length<3?(i(),D("div",{key:0,style:K({height:(u-n.renderList.length)*86+"px"})},null,4)):I("",!0)]),_:1})}}});var ft=A(pt,[["__scopeId","data-v-5a5ae578"]]);const gt=F({setup(n){const{loading:t,setLoading:r}=nt(!0),_=E("message"),{t:f}=ne(),u=De({renderList:[],messageList:[]});Ie(u);const v=[{key:"message",title:f("messageBox.tab.title.message")},{key:"notice",title:f("messageBox.tab.title.notice")},{key:"todo",title:f("messageBox.tab.title.todo")}];async function b(){r(!0);try{const{data:d}=await et();u.messageList=d}catch{}finally{r(!1)}}async function x(d){const L=d.map(y=>y.id);await tt({ids:L}),b()}const c=w(()=>u.messageList.filter(d=>_.value===d.type)),l=w(()=>c.value.filter(d=>!d.status).length),h=d=>u.messageList.filter(y=>y.type===d&&!y.status),k=d=>{const L=h(d);return L.length?`(${L.length})`:""},a=d=>{c.value.length&&x([...d])},S=()=>{u.messageList=[]};return b(),(d,L)=>{const y=s("a-result"),C=s("a-tab-pane"),R=s("a-button"),$=s("a-tabs"),z=s("a-spin");return i(),m(z,{style:{display:"block"},loading:g(t)},{default:e(()=>[o($,{activeKey:_.value,"onUpdate:activeKey":L[0]||(L[0]=T=>_.value=T),type:"rounded","destroy-on-hide":""},{extra:e(()=>[o(R,{type:"text",onClick:S},{default:e(()=>[B(M(d.$t("messageBox.tab.button")),1)]),_:1})]),default:e(()=>[(i(),D(W,null,q(v,T=>o(C,{key:T.key},{title:e(()=>[p("span",null,M(T.title)+M(k(T.key)),1)]),default:e(()=>[g(c).length?I("",!0):(i(),m(y,{key:0,status:"404"},{subtitle:e(()=>[B(M(d.$t("messageBox.noContent")),1)]),_:1})),o(ft,{"render-list":g(c),"unread-count":g(l),onItemClick:a},null,8,["render-list","unread-count"])]),_:2},1024)),64))]),_:1},8,["activeKey"])]),_:1},8,["loading"])}}});var vt=A(gt,[["__scopeId","data-v-0c764968"]]);const ht=n=>(oe("data-v-62be66ba"),n=n(),ae(),n),yt={class:"navbar"},mt={class:"left-side"},bt=ht(()=>p("img",{alt:"logo",src:"//p3-armor.byteimg.com/tos-cn-i-49unhts6dw/dfdba5317c0c20ce20e64fac803d52bc.svg~tplv-49unhts6dw-image.image"},null,-1)),kt=B(" milimili "),Ct={class:"right-side"},$t={class:"message-box-trigger"},Lt=["src"],wt=F({setup(n){const t=P(),r=Z(),{logout:_}=at(),{changeLocale:f}=Qe(),{isFullscreen:u,toggle:v}=Fe(),b=[...Ze],x=w(()=>r.avatar),c=w(()=>t.theme),l=Ee({selector:"body",attribute:"arco-theme",valueDark:"dark",valueLight:"light",storageKey:"arco-theme",onChanged($){t.toggleTheme($)}}),h=Re(l),k=()=>{h()},a=()=>{t.updateSettings({globalSettings:!0})},S=E(),d=E(),L=()=>{const $=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});S.value.dispatchEvent($)},y=()=>{_()},C=()=>{const $=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});d.value.dispatchEvent($)},R=ze("toggleDrawerMenu");return($,z)=>{const T=s("a-typography-title"),pe=s("icon-menu-fold"),H=s("a-space"),fe=s("icon-language"),j=s("a-button"),N=s("a-tooltip"),J=s("a-doption"),G=s("a-dropdown"),ge=s("icon-moon-fill"),ve=s("icon-sun-fill"),he=s("icon-notification"),ye=s("a-badge"),me=s("a-popover"),be=s("icon-fullscreen-exit"),ke=s("icon-fullscreen"),X=s("icon-settings"),Ce=s("a-avatar"),$e=s("icon-export");return i(),D("div",yt,[p("div",mt,[o(H,null,{default:e(()=>[bt,o(T,{style:{margin:0,fontSize:"18px"},heading:5},{default:e(()=>[kt]),_:1}),g(t).device==="mobile"?(i(),m(pe,{key:0,style:{"font-size":"22px",cursor:"pointer"},onClick:g(R)},null,8,["onClick"])):I("",!0)]),_:1})]),p("ul",Ct,[p("li",null,[o(N,{content:$.$t("settings.language")},{default:e(()=>[o(j,{class:"nav-btn",type:"outline",shape:"circle",onClick:C},{icon:e(()=>[o(fe)]),_:1})]),_:1},8,["content"]),o(G,{trigger:"click",onSelect:g(f)},{content:e(()=>[(i(),D(W,null,q(b,V=>o(J,{key:V.value,value:V.value},{default:e(()=>[B(M(V.label),1)]),_:2},1032,["value"])),64))]),default:e(()=>[p("div",{ref_key:"triggerBtn",ref:d,class:"trigger-btn"},null,512)]),_:1},8,["onSelect"])]),p("li",null,[o(N,{content:g(c)==="light"?$.$t("settings.navbar.theme.toDark"):$.$t("settings.navbar.theme.toLight")},{default:e(()=>[o(j,{class:"nav-btn",type:"outline",shape:"circle",onClick:k},{icon:e(()=>[g(c)==="dark"?(i(),m(ge,{key:0})):(i(),m(ve,{key:1}))]),_:1})]),_:1},8,["content"])]),p("li",null,[o(N,{content:$.$t("settings.navbar.alerts")},{default:e(()=>[p("div",$t,[o(ye,{count:9,dot:""},{default:e(()=>[o(j,{class:"nav-btn",type:"outline",shape:"circle",onClick:L},{default:e(()=>[o(he)]),_:1})]),_:1})])]),_:1},8,["content"]),o(me,{trigger:"click","arrow-style":{display:"none"},"content-style":{padding:0,minWidth:"400px"},"content-class":"message-popover"},{content:e(()=>[o(vt)]),default:e(()=>[p("div",{ref_key:"refBtn",ref:S,class:"ref-btn"},null,512)]),_:1})]),p("li",null,[o(N,{content:g(u)?$.$t("settings.navbar.screen.toExit"):$.$t("settings.navbar.screen.toFull")},{default:e(()=>[o(j,{class:"nav-btn",type:"outline",shape:"circle",onClick:g(v)},{icon:e(()=>[g(u)?(i(),m(be,{key:0})):(i(),m(ke,{key:1}))]),_:1},8,["onClick"])]),_:1},8,["content"])]),p("li",null,[o(N,{content:$.$t("settings.title")},{default:e(()=>[o(j,{class:"nav-btn",type:"outline",shape:"circle",onClick:a},{icon:e(()=>[o(X)]),_:1})]),_:1},8,["content"])]),p("li",null,[o(G,{trigger:"click"},{content:e(()=>[o(J,null,{default:e(()=>[o(H,{onClick:z[0]||(z[0]=V=>$.$router.push({name:"Setting"}))},{default:e(()=>[o(X),p("span",null,M($.$t("messageBox.userSettings")),1)]),_:1})]),_:1}),o(J,null,{default:e(()=>[o(H,{onClick:y},{default:e(()=>[o($e),p("span",null,M($.$t("messageBox.logout")),1)]),_:1})]),_:1})]),default:e(()=>[o(Ce,{size:32,style:{marginRight:"8px",cursor:"pointer"}},{default:e(()=>[p("img",{alt:"avatar",src:g(x)},null,8,Lt)]),_:1})]),_:1})])])])}}});var xt=A(wt,[["__scopeId","data-v-62be66ba"]]);const St=[...Ge],Mt=St.map(n=>{const{name:t,path:r,meta:_,redirect:f,children:u}=n;return{name:t,path:r,meta:_,redirect:f,children:u}});function Bt(){const n=ie(),t=P(),r=w(()=>t.menuFromServer?t.appAsyncMenus:Mt);return{menuTree:w(()=>{const f=JSON.parse(JSON.stringify(r.value));console.log(f),f.sort((v,b)=>(v.meta.order||0)-(b.meta.order||0));function u(v,b){return v?v.map(c=>{var h,k;if(!n.accessRouter(c))return null;if(((h=c.meta)==null?void 0:h.hideChildrenInMenu)||!c.children)return c.children=[],c;c.children=c.children.filter(a=>{var S;return((S=a.meta)==null?void 0:S.hideInMenu)!==!0});const l=u(c.children,b+1);return l.length||b>1?(c.children=l,c):((k=c.meta)==null?void 0:k.hideInMenu)===!1?c:null}).filter(Boolean):null}return u(f,0)})}}function Tt(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Ae(n)}var Dt=F({emit:["collapse"],setup(){const{t:n}=ne(),t=P(),r=O(),{menuTree:_}=Bt(),f=w({get(){return t.device==="desktop"?t.menuCollapse:!1},set(l){t.updateSettings({menuCollapse:l})}}),u=E([]),v=E([]),b=l=>{if(Xe.test(l.path)){Ye(l.path),v.value=[l.name];return}r.push({name:l.name})};ue(l=>{var h;if(l.meta.requiresAuth&&!l.meta.hideInMenu){const{matched:k}=l;if(k.length>1&&k.slice(0,k.length-1).forEach(({name:a})=>{u.value.includes(a)||u.value.push(a)}),l.meta.activeMenu)v.value=[l.meta.activeMenu];else{const a=(h=k[k.length-1])==null?void 0:h.name;v.value=[a]}}},!0);const x=l=>{t.device==="desktop"&&t.updateSettings({menuCollapse:l})},c=()=>{function l(h,k=[]){return h&&h.forEach(a=>{var L;const S=((L=a==null?void 0:a.meta)==null?void 0:L.icon)?()=>{var y;return se(ce(`<${(y=a==null?void 0:a.meta)==null?void 0:y.icon}/>`))}:null,d=(a==null?void 0:a.children)&&(a==null?void 0:a.children.length)!==0?o(s("a-sub-menu"),{key:a==null?void 0:a.name},{default:()=>[l(a==null?void 0:a.children)],icon:S,title:()=>{var y;return se(ce(n(((y=a==null?void 0:a.meta)==null?void 0:y.locale)||"")))}}):o(s("a-menu-item"),{key:a==null?void 0:a.name,onClick:()=>b(a)},{default:()=>{var y;return[n(((y=a==null?void 0:a.meta)==null?void 0:y.locale)||"")]},icon:S});k.push(d)}),k}return l(_.value)};return()=>{let l;return o(s("a-menu"),{collapsed:f.value,"onUpdate:collapsed":h=>f.value=h,"open-keys":u.value,"onUpdate:open-keys":h=>u.value=h,"show-collapse-button":t.device!=="mobile","auto-open":!1,"selected-keys":v.value,"auto-open-selected":!0,"level-indent":34,style:"height: 100%",onCollapse:x},Tt(l=c())?l:{default:()=>[l]})}}});var _e=A(Dt,[["__scopeId","data-v-3a39ad32"]]);const It=n=>(oe("data-v-046880be"),n=n(),ae(),n),Ft={class:"tab-bar-container"},Et={class:"tab-bar-box"},Rt={class:"tab-bar-scroll"},zt={class:"tags-wrap"},At=["onClick"],Pt={class:"tag-link"},jt=["onClick"],Nt=It(()=>p("div",{class:"tag-bar-operation"},null,-1)),Ut=F({setup(n){const t=P(),r=de(),_=O(),f=E(),u=w(()=>r.getTabList),v=w(()=>t.navbar?60:0);le(()=>t.navbar,()=>{f.value.updatePosition()}),ue(c=>{!c.meta.noAffix&&!u.value.some(l=>l.fullPath===c.fullPath)&&r.updateTabList(c)},!0);const b=(c,l)=>{if(r.deleteTag(l,c),l===u.value.length){const h=u.value[u.value.length-1];_.push({name:h.name})}},x=c=>{_.push(U({},c))};return(c,l)=>{const h=s("icon-close"),k=s("a-affix");return i(),D("div",Ft,[o(k,{ref_key:"affixRef",ref:f,"offset-top":g(v)},{default:e(()=>[p("div",Et,[p("div",Rt,[p("div",zt,[(i(!0),D(W,null,q(g(u),(a,S)=>(i(),D("span",{key:a.fullPath,class:Q(["arco-tag arco-tag-size-medium arco-tag-checked",{"link-activated":a.fullPath===c.$route.fullPath}]),onClick:d=>x(a)},[p("span",Pt,M(c.$t(a.title)),1),p("span",{class:"arco-icon-hover arco-tag-icon-hover arco-icon-hover-size-medium arco-tag-close-btn",onClick:Pe(d=>b(a,S),["stop"])},[o(h)],8,jt)],10,At))),128))])]),Nt])]),_:1},8,["offset-top"])])}}});var Vt=A(Ut,[["__scopeId","data-v-046880be"]]);function Ot(n,t,r,_=!1){n.addEventListener&&typeof n.addEventListener=="function"&&n.addEventListener(t,r,_)}function qt(n,t,r,_=!1){n.removeEventListener&&typeof n.removeEventListener=="function"&&n.removeEventListener(t,r,_)}const Kt=992;function Wt(){return document.body.getBoundingClientRect().width-1<Kt}function Ht(n){const t=P();function r(){if(!document.hidden){const f=Wt();t.toggleDevice(f?"mobile":"desktop"),t.toggleMenu(f)}}const _=Ve(r,100);je(()=>{n&&_()}),Ne(()=>{Ot(window,"resize",_)}),Ue(()=>{qt(window,"resize",_)})}const Jt=F({setup(n){const t=de(),r=w(()=>t.getCacheList);return(_,f)=>{const u=s("router-view");return i(),m(u,null,{default:e(({Component:v,route:b})=>[o(qe,{name:"fade",mode:"out-in",appear:""},{default:e(()=>[b.meta.ignoreCache?(i(),m(re(v),{key:b.fullPath})):(i(),m(Oe,{key:1,include:g(r)},[(i(),m(re(v),{key:b.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})}}});const Qt={key:0,class:"layout-navbar"},Zt={class:"menu-wrapper"},Gt=F({setup(n){const t=P(),r=Z(),_=O(),f=Ke(),u=ie();Ht(!0);const v="60px",b=w(()=>t.navbar),x=w(()=>t.menu),c=w(()=>t.hideMenu),l=w(()=>t.footer),h=w(()=>t.menuCollapse?48:t.menuWidth),k=w(()=>t.menuCollapse),a=w(()=>{const y=x.value&&!c.value?{paddingLeft:`${h.value}px`}:{},C=b.value?{paddingTop:v}:{};return U(U({},y),C)}),S=y=>{t.updateSettings({menuCollapse:y})};le(()=>r.role,y=>{y&&!u.accessRouter(f)&&_.push({name:"notFound"})});const d=E(!1),L=()=>{d.value=!1};return We("toggleDrawerMenu",()=>{d.value=!d.value}),(y,C)=>{const R=s("a-layout-sider"),$=s("a-drawer"),z=s("a-layout-content"),T=s("a-layout");return i(),m(T,{class:Q(["layout",{mobile:g(t).hideMenu}])},{default:e(()=>[g(b)?(i(),D("div",Qt,[o(xt)])):I("",!0),o(T,null,{default:e(()=>[o(T,null,{default:e(()=>[g(x)?He((i(),m(R,{key:0,class:"layout-sider",breakpoint:"xl",collapsed:g(k),collapsible:!0,width:g(h),style:K({paddingTop:g(b)?"60px":""}),"hide-trigger":!0,onCollapse:S},{default:e(()=>[p("div",Zt,[o(_e)])]),_:1},8,["collapsed","width","style"])),[[Je,!g(c)]]):I("",!0),g(c)?(i(),m($,{key:1,visible:d.value,placement:"left",footer:!1,"mask-closable":"",closable:!1,onCancel:L},{default:e(()=>[o(_e)]),_:1},8,["visible"])):I("",!0),o(T,{class:"layout-content",style:K(g(a))},{default:e(()=>[g(t).tabBar?(i(),m(Vt,{key:0})):I("",!0),o(z,null,{default:e(()=>[o(Jt)]),_:1}),g(l)?(i(),m(ot,{key:1})):I("",!0)]),_:1},8,["style"])]),_:1})]),_:1})]),_:1},8,["class"])}}});var an=A(Gt,[["__scopeId","data-v-613e0a32"]]);export{an as default};
